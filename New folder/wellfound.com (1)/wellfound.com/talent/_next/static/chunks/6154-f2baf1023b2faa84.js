(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6154],{66962:function(t,e,n){"use strict";n.d(e,{q:function(){return Oa}});var r=n(96086),i=n.n(r),s=function(t){return void 0!==t&&null!==t&&"function"===typeof t.then};function a(t,e){return!(!f(t)||!f(e))&&t.slice(0,e.length)===e}function o(t,e,n){var r=n;try{var i=e.split("."),s=t;i.forEach((function(t){return s=s[t]})),"undefined"!==typeof s&&(r=s)}catch(a){}return r}function u(t,e){if(Array.isArray(t)&&"function"===typeof e)for(var n=0;n<t.length;n++)if(!0===e(t[n],n,t))return n;return-1}function c(t,e){var n;if(g(t))for(var r=Object.keys(t),i=0;i<r.length&&!n;i++){var s=r[i];e(t[s],s,t)&&(n=t[s])}else if(Array.isArray(t))for(var a=0;a<t.length&&!n;a++){e(t[a],a,t)&&(n=t[a])}return n}function f(t){return"string"===typeof t||t instanceof String}function l(t){return t instanceof Number&&(t=t.valueOf()),"number"===typeof t&&(Number.isFinite?Number.isFinite(t):isFinite(t))}function h(t){return t instanceof Number&&(t=t.valueOf()),t!==t}var p=-1;function g(t){return t&&"object"===typeof t&&t.constructor===Object}function d(t,e){var n=t;g(e)&&Object.keys(e).forEach((function(t){var r=e[t];g(r)&&(r=n[t]&&g(n[t])?d({},n[t],r):d({},r)),void 0!==r&&(n[t]=r)}));for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];if(i&&i.length){var a=i.splice(0,1)[0];n=d.apply(void 0,[n,a].concat(i))}return n}function m(t){var e={};return t.filter((function(t){return!Object.prototype.hasOwnProperty.call(e,t)&&(e[t]=!0)}))}function v(t){if(null==t)return"";if("string"===typeof t)return t;if(Array.isArray(t))return t.map((function(t){return f(t)?t:""}))+"";var e=t+"";return"0"===e&&1/t===Number.NEGATIVE_INFINITY?"-0":e}function y(t){if("number"===typeof t)return t;if(g(t)&&"function"===typeof t.valueOf){var e=t.valueOf();t=g(e)?e+"":e}return"string"!==typeof t?0===t?t:+t:+(t=t.replace(/^\s+|\s+$/g,""))}function S(t,e){return Object.keys(t).forEach((function(n){return e(t[n],n,t)})),t}function T(t){return!0===t||!1===t}var E={DEBUG:"DEBUG",INFO:"INFO",WARN:"WARN",ERROR:"ERROR",NONE:"NONE"},b={DEBUG:1,INFO:2,WARN:3,ERROR:4,NONE:5},_=b.DEBUG,A=function(t){_=b[t]},N={showLevel:!0,displayAllErrors:!1},R=function(){function t(t,e){this.category=t,this.options=i()({},N,e)}var e=t.prototype;return e.debug=function(t){this._shouldLog(b.DEBUG)&&this._log(E.DEBUG,t)},e.info=function(t){this._shouldLog(b.INFO)&&this._log(E.INFO,t)},e.warn=function(t){this._shouldLog(b.WARN)&&this._log(E.WARN,t)},e.error=function(t){(this.options.displayAllErrors||this._shouldLog(b.ERROR))&&this._log(E.ERROR,t)},e._log=function(t,e){var n=this._generateLogMessage(t,e);console.log(n)},e._generateLogMessage=function(t,e){var n="";return this.options.showLevel&&(n+="["+t+"]"+(t===E.INFO||t===E.WARN?" ":"")+" "),this.category&&(n+=this.category+" => "),n+e},e._shouldLog=function(t){return t>=_},t}();function w(){var t="__SPLITSOFTWARE__";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(e){return!1}}var C=n(34155),k=function(t){return!!c(E,(function(e){return t===e}))},O={showLevel:!0,displayAllErrors:!1},I=!1;"undefined"!==typeof C&&"undefined"!==typeof C.version&&C.version&&(I=!0);var D=String(I?C.env.SPLITIO_DEBUG:w()?localStorage.getItem("splitio_debug"):""),M=function(t,e){return void 0===e&&(e={}),new R(t,d(e,O))},K=M("splitio-utils:logger"),P={enable:function(){A(E.DEBUG)},setLogLevel:function(t){k(t)?A(t):K.error("Invalid Log Level - No changes to the logs will be applied.")},disable:function(){A(E.NONE)},LogLevel:E};/^(enabled?|on)/i.test(D)?P.enable(E.DEBUG):k(D)?P.setLogLevel(D):P.disable();var x=M,L=x("",{displayAllErrors:!0}),F={};function G(t){F[t]&&F[t]--,0===F[t]&&delete F[t]}var U=x("");var j=x("");function z(t,e){return g(t)||void 0==t?t:(j.error(e+": attributes must be a plain object."),!1)}function W(t,e){if(!z(t,e))return!1;var n=!0;return Object.keys(t).forEach((function(r){(function(t,e,n){if(!f(t)||0===t.length)return U.warn(n+": you passed an invalid attribute name, attribute name must be a non-empty string."),!1;var r=f(e),i=l(e),s=T(e),a=Array.isArray(e);return!!(r||i||s||a)||(U.warn(n+": you passed an invalid attribute value for "+t+". Acceptable types are: string, number, boolean and array of strings."),!1)})(r,t[r],e)||(n=!1)})),n}var H=x(""),B=/^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/;function Y(t,e){if(void 0==t)H.error(e+": you passed a null or undefined event_type, event_type must be a non-empty string.");else if(f(t))if(0===t.length)H.error(e+": you passed an empty event_type, event_type must be a non-empty string.");else{if(B.test(t))return t;H.error(e+': you passed "'+t+'", event_type must adhere to the regular expression /^[a-zA-Z0-9][-_.:a-zA-Z0-9]{0,79}$/g. This means an event_type must be alphanumeric, cannot be more than 80 characters long, and can only include a dash, underscore, period, or colon as separators of alphanumeric characters.')}else H.error(e+": you passed an invalid event_type, event_type must be a non-empty string.");return!1}var q=x("");function V(t,e){return l(t)||void 0==t?t:(q.error(e+": value must be a finite number."),!1)}var J=x(""),Q=0,Z=2,$=4,X=8,tt=1024;function et(t,e){if(void 0==t)return{properties:null,size:tt};if(!g(t))return J.error(e+": properties must be a plain object."),{properties:!1,size:tt};var n=Object.keys(t),r=function(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++)n[e[r]]=t[e[r]];return n}(t),i={properties:r,size:tt};n.length>300&&J.warn(e+": Event has more than 300 properties. Some of them will be trimmed when processed.");for(var s=0;s<n.length;s++){i.size+=n[s].length*Z;var a=r[n[s]],o=f(a),u=l(a),c=T(a),h=null===a;if(o||u||c||h||(r[n[s]]=null,a=null,h=!0,J.warn(e+": Property "+n[s]+" is of invalid type. Setting value to null.")),h?i.size+=Q:u?i.size+=X:c?i.size+=$:o&&(i.size+=a.length*Z),i.size>32768){J.error(e+": The maximum size allowed for the properties is 32768 bytes, which was exceeded. Event not queued."),i.properties=!1;break}}return i}var nt=x("");function rt(t,e,n){if(void 0==t)return nt.error(e+": you passed a null or undefined "+n+", "+n+" must be a non-empty string."),!1;if(l(t))return nt.warn(e+": "+n+' "'+t+'" is not of type string, converting.'),v(t);if(f(t)){if((t=t.trim()).length>0&&t.length<=250)return t;0===t.length?nt.error(e+": you passed an empty string, "+n+" must be a non-empty string."):t.length>250&&nt.error(e+": "+n+" too long, "+n+" must be 250 characters or less.")}else nt.error(e+": you passed an invalid "+n+" type, "+n+" must be a non-empty string.");return!1}function it(t,e){if(g(t)){var n=rt(t.matchingKey,e,"matchingKey"),r=rt(t.bucketingKey,e,"bucketingKey");return n&&r?{matchingKey:n,bucketingKey:r}:(nt.error(e+": Key must be an object with bucketingKey and matchingKey with valid string properties."),!1)}return rt(t,e,"key")}var st="definition not found",at="exception",ot=x(""),ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/;function ct(t,e,n){if(void 0===n&&(n="split name"),void 0==t)ot.error(e+": you passed a null or undefined "+n+", "+n+" must be a non-empty string.");else if(f(t)){if(ut.test(t)&&(ot.warn(e+": "+n+' "'+t+'" has extra whitespace, trimming.'),t=t.trim()),t.length>0)return t;ot.error(e+": you passed an empty "+n+", "+n+" must be a non-empty string.")}else ot.error(e+": you passed an invalid "+n+", "+n+" must be a non-empty string.");return!1}function ft(t,e,n,r){return!t.get(t.constants.READY,!0)||n!==st&&null!=n||(ot.warn(r+': you passed "'+e+'" that does not exist in this environment, please double check what Splits exist in the web console.'),!1)}var lt=x("");function ht(t,e,n,r){if(void 0===n&&(n="split_names"),void 0===r&&(r="split name"),Array.isArray(t)&&t.length>0){var i=[];if(t.forEach((function(t){var n=ct(t,e,r);n&&i.push(n)})),i.length)return m(i)}return lt.error(e+": "+n+" must be a non-empty array."),!1}var pt="localhost",gt="standalone",dt="producer",mt="consumer",vt="MEMORY",yt="LOCALSTORAGE",St="control",Tt={treatment:St,config:null},Et="GOOGLE_ANALYTICS_TO_SPLIT",bt="SPLIT_TO_GOOGLE_ANALYTICS",_t="IMPRESSION",At="EVENT",Nt=[{type:"byName",maxLength:400,queryParam:"names="},{type:"byPrefix",maxLength:50,queryParam:"prefixes="}],Rt="DEBUG",wt="OPTIMIZED",Ct=x(""),kt=/[A-Z]/;function Ot(t,e){if(void 0==t)Ct.error(e+": you passed a null or undefined traffic_type_name, traffic_type_name must be a non-empty string.");else if(f(t)){if(0!==t.length)return kt.test(t)&&(Ct.warn(e+": traffic_type_name should be all lowercase - converting string to lowercase."),t=t.toLowerCase()),t;Ct.error(e+": you passed an empty traffic_type_name, traffic_type_name must be a non-empty string.")}else Ct.error(e+": you passed an invalid traffic_type_name, traffic_type_name must be a non-empty string.");return!1}function It(t,e){Ct.warn(t+": Traffic Type "+e+" does not have any corresponding Splits in this environment, make sure you're tracking your events to a valid traffic type defined in the Split console.")}var Dt=x("",{displayAllErrors:!0});function Mt(t){return!t.get(t.constants.DESTROYED,!0)||(Dt.error("Client has already been destroyed - no calls possible."),!1)}function Kt(t,e){return!(!t.get(t.constants.READY,!0)&&!t.get(t.constants.READY_FROM_CACHE,!0))||(Dt.warn(e+": the SDK is not ready, results may be incorrect. Make sure to wait for SDK readiness before using this method."),!1)}var Pt=function(t){var e=t.conditions,n=c(e,(function(t){return"ROLLOUT"===t.conditionType}));return n||(n=e[0]),n?n.partitions.map((function(t){return t.treatment})):[]},xt=function(t){var e;try{e=JSON.parse(t)}catch(n){return null}return null==e?null:{name:e.name,trafficType:e.trafficTypeName||null,killed:e.killed,changeNumber:e.changeNumber||0,treatments:Pt(e),configs:e.configurations||{}}},Lt=function(t){var e=[];return t.forEach((function(t){var n=xt(t);null!=n&&e.push(n)})),e};var Ft=function(t,e){var n="split",r=e.get(e.constants.STATUS_MANAGER);return i()(Object.create(r),{split:function(r){var i=ct(r,n);if(!Mt(e)||!Kt(e,n)||!i)return null;var a=t.getSplit(i);return s(a)?a.then((function(t){return ft(e,i,t,n),xt(t)})):(ft(e,i,a,n),xt(a))},splits:function(){if(!Mt(e)||!Kt(e,"splits"))return[];var n=t.getAll();return s(n)?n.then(Lt):Lt(n)},names:function(){return Mt(e)&&Kt(e,"names")?t.getKeys():[]}})};var Gt=function(t){void 0===t&&(t=[]);for(var e=0;e<t.length;e++)for(var n=t[e].matcherGroup.matchers,r=0;r<n.length;r++)if("IN_SEGMENT"===n[r].matcherType)return!0;return!1};function Ut(t,e,n){var r=this,i=this.getSplit(t);return(s(i)?i:Promise.resolve(i)).then((function(i){if(i){var s=JSON.parse(i);if(!s.changeNumber||s.changeNumber<n){s.killed=!0,s.defaultTreatment=e,s.changeNumber=n;var a=JSON.stringify(s);return r.addSplit(t,a)}}return!1}))}var jt=function(){function t(){this.flush()}var e=t.prototype;return e.addSplit=function(t,e){var n=this.getSplit(t);if(n){var r=JSON.parse(n);if(r.trafficTypeName){var i=r.trafficTypeName;this.ttCache[i]--,this.ttCache[i]||delete this.ttCache[i]}Gt(r.conditions)&&this.splitsWithSegmentsCount--}var s=JSON.parse(e);if(s){this.splitCache[t]=e;var a=s.trafficTypeName;return a&&(this.ttCache[a]||(this.ttCache[a]=0),this.ttCache[a]++),Gt(s.conditions)&&this.splitsWithSegmentsCount++,!0}return!1},e.addSplits=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n},e.removeSplit=function(t){var e=this.getSplit(t);if(e){delete this.splitCache[t];var n=JSON.parse(e),r=n.trafficTypeName;return r&&(this.ttCache[r]--,this.ttCache[r]||delete this.ttCache[r]),Gt(n.conditions)&&this.splitsWithSegmentsCount--,1}return 0},e.removeSplits=function(t){var e=this;return t.forEach((function(t){return e.removeSplit(t)})),t.length},e.getSplit=function(t){return this.splitCache[t]},e.setChangeNumber=function(t){return this.changeNumber=t,!0},e.getChangeNumber=function(){return this.changeNumber},e.getAll=function(){var t=this;return this.getKeys().map((function(e){return t.splitCache[e]}))},e.getKeys=function(){return Object.keys(this.splitCache)},e.trafficTypeExists=function(t){return l(this.ttCache[t])&&this.ttCache[t]>0},e.usesSegments=function(){return-1===this.getChangeNumber()||this.splitsWithSegmentsCount>0},e.flush=function(){this.splitCache={},this.ttCache={},this.changeNumber=-1,this.splitsWithSegmentsCount=0},e.fetchMany=function(t){var e=this,n={};return t.forEach((function(t){n[t]=e.splitCache[t]||null})),n},e.checkCache=function(){return!1},t}();jt.prototype.killLocally=Ut;var zt=jt,Wt=x("splitio-storage:localstorage"),Ht=function(){function t(t,e,n){void 0===n&&(n={validFilters:[],queryString:null,groupedFilters:{byName:[],byPrefix:[]}}),this.keys=t,this.splitFiltersValidation=n,this.__checkExpiration(e),this.__checkFilterQuery()}var e=t.prototype;return e.decrementCount=function(t){var e=y(localStorage.getItem(t))-1;e>0?localStorage.setItem(t,e):localStorage.removeItem(t)},e.decrementCounts=function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);this.decrementCount(e)}if(Gt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();this.decrementCount(n)}}}catch(r){Wt.error(r)}},e.incrementCounts=function(t){try{if(t){if(t.trafficTypeName){var e=this.keys.buildTrafficTypeKey(t.trafficTypeName);localStorage.setItem(e,y(localStorage.getItem(e))+1)}if(Gt(t.conditions)){var n=this.keys.buildSplitsWithSegmentCountKey();localStorage.setItem(n,y(localStorage.getItem(n))+1)}}}catch(r){Wt.error(r)}},e.addSplit=function(t,e){try{var n=this.keys.buildSplitKey(t),r=localStorage.getItem(n),i=r?JSON.parse(r):null;this.decrementCounts(i),localStorage.setItem(n,e);var s=e?JSON.parse(e):null;return this.incrementCounts(s),!0}catch(a){return Wt.error(a),!1}},e.addSplits=function(t){var e=this,n=[];return t.forEach((function(t){n.push(e.addSplit(t[0],t[1]))})),n},e.removeSplit=function(t){try{var e=this.getSplit(t);localStorage.removeItem(this.keys.buildSplitKey(t));var n=JSON.parse(e);return this.decrementCounts(n),1}catch(r){return Wt.error(r),0}},e.removeSplits=function(t){for(var e=0,n=t.length,r=0;e<n;e++)r+=this.removeSplit(t[e]);return r},e.getSplit=function(t){return localStorage.getItem(this.keys.buildSplitKey(t))},e.setChangeNumber=function(t){if(this.cacheReadyButNeedsToFlush&&(this.flush(),this.cacheReadyButNeedsToFlush=!1),this.updateNewFilter){Wt.info("Split filter query was modified. Updating cache.");var e=this.keys.buildSplitsFilterQueryKey(),n=this.splitFiltersValidation.queryString;try{n?localStorage.setItem(e,n):localStorage.removeItem(e)}catch(r){Wt.error(r)}this.updateNewFilter=!1}try{return localStorage.setItem(this.keys.buildSplitsTillKey(),t+""),localStorage.setItem(this.keys.buildLastUpdatedKey(),Date.now()+""),this.hasSync=!0,!0}catch(r){return Wt.error(r),!1}},e.getChangeNumber=function(){var t=localStorage.getItem(this.keys.buildSplitsTillKey());return null!==t?h(t=parseInt(t,10))?-1:t:-1},e.getAll=function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n),i=r&&localStorage.getItem(r);null!=r&&this.keys.isSplitKey(r)&&i&&e.push(i),n++}return e},e.getKeys=function(){for(var t=localStorage.length,e=[],n=0;n<t;){var r=localStorage.key(n);null!=r&&this.keys.isSplitKey(r)&&e.push(this.keys.extractKey(r)),n++}return e},e.trafficTypeExists=function(t){var e=y(localStorage.getItem(this.keys.buildTrafficTypeKey(t)));return l(e)&&e>0},e.usesSegments=function(){if(!this.hasSync)return!0;var t=localStorage.getItem(this.keys.buildSplitsWithSegmentCountKey()),e=null===t?0:y(t);return!l(e)||e>0},e.flush=function(){Wt.info("Flushing Splits data from localStorage");for(var t=localStorage.length,e=[],n=0;n<t;n++){var r=localStorage.key(n);null!=r&&this.keys.isSplitCacheKey(r)&&e.push(r)}e.forEach((function(t){localStorage.removeItem(t)})),this.hasSync=!1},e.fetchMany=function(t){var e=this,n={};return t.forEach((function(t){n[t]=localStorage.getItem(e.keys.buildSplitKey(t))})),n},e.checkCache=function(){return this.getChangeNumber()>-1||this.cacheReadyButNeedsToFlush},e.__checkExpiration=function(t){var e=localStorage.getItem(this.keys.buildLastUpdatedKey());null!==e&&!h(e=parseInt(e,10))&&e<t&&this.flush()},e.__checkFilterQuery=function(){var t=this,e=this.splitFiltersValidation,n=e.queryString,r=e.groupedFilters,i=this.keys.buildSplitsFilterQueryKey();if(localStorage.getItem(i)!==n)try{this.updateNewFilter=!0,this.checkCache()&&(localStorage.setItem(this.keys.buildSplitsTillKey(),"-1"),this.getKeys().forEach((function(e){n&&(r.byName.indexOf(e)>-1||r.byPrefix.some((function(t){return e.startsWith(t+"__")})))?t.cacheReadyButNeedsToFlush=!0:t.removeSplit(e)})))}catch(s){Wt.error(s)}},t}();Ht.prototype.killLocally=Ut;var Bt=Ht,Yt=function(){function t(t){this.keys=t,this.flush()}var e=t.prototype;return e.flush=function(){this.segmentCache={}},e.addToSegment=function(t){var e=this.keys.buildSegmentNameKey(t);return this.segmentCache[e]=!0,!0},e.removeFromSegment=function(t){var e=this.keys.buildSegmentNameKey(t);return delete this.segmentCache[e],!0},e.resetSegments=function(t){var e,n=this,r=!1,i=Object.keys(this.segmentCache);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)}));else{for(e=0;e<t.length&&this.isInSegment(t[e]);e++);e<t.length&&(r=!0,this.segmentCache={},t.forEach((function(t){n.addToSegment(t)})))}return r},e.isInSegment=function(t){var e=this.keys.buildSegmentNameKey(t);return!0===this.segmentCache[e]},e.setChangeNumber=function(){return!0},e.getChangeNumber=function(){return-1},e.registerSegment=function(){return!1},e.registerSegments=function(){return!1},e.getRegisteredSegments=function(){return[]},t}(),qt=x("splitio-storage:localstorage"),Vt=function(){function t(t){this.keys=t}var e=t.prototype;return e.addToSegment=function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.setItem(e,"1"),!0}catch(n){return qt.error(n),!1}},e.removeFromSegment=function(t){var e=this.keys.buildSegmentNameKey(t);try{return localStorage.removeItem(e),!0}catch(n){return qt.error(n),!1}},e.resetSegments=function(t){var e,n=this,r=!1,i=Object.keys(localStorage).reduce((function(e,r){var i=n.keys.extractSegmentName(r);if(i)e.push(i);else if(i=n.keys.extractOldSegmentKey(r)){var s=n.keys.buildSegmentNameKey(i);try{!localStorage.getItem(s)&&t.indexOf(i)>-1&&(localStorage.setItem(s,"1"),e.push(i)),localStorage.removeItem(r)}catch(a){qt.error(a)}}return e}),[]);if(0===t.length&&i.length===t.length)return r;if(i.length!==t.length)r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)}));else{for(e=0;e<t.length&&-1!==i.indexOf(t[e]);e++);e<t.length&&(r=!0,i.forEach((function(t){return n.removeFromSegment(t)})),t.forEach((function(t){return n.addToSegment(t)})))}return r},e.isInSegment=function(t){return"1"===localStorage.getItem(this.keys.buildSegmentNameKey(t))},e.setChangeNumber=function(){return!0},e.getChangeNumber=function(){return-1},e.registerSegment=function(){return!1},e.registerSegments=function(){return!1},e.getRegisteredSegments=function(){return[]},e.flush=function(){qt.info("Flushing MySegments data from localStorage"),this.resetSegments([])},t}(),Jt=function(){function t(){this.queue=[]}var e=t.prototype;return e.state=function(){return this.queue},e.track=function(t){var e;return(e=this.queue).push.apply(e,t),this},e.clear=function(){return this.queue.length=0,this},e.toJSON=function(){return this.queue},e.isEmpty=function(){return 0===this.queue.length},t}();var Qt=function(t,e){for(var n=0,r=t.length-1,i=Math.floor((r+n)/2),s=n,a=r;t[i]!==e&&n<r;)e<t[i]?r=i-1:e>t[i]&&(n=i+1),i=Math.floor((r+n)/2);return i<s?i=s:i>a&&(i=a),e<t[i]&&i>s?i-1:i},Zt=Qt.bind(null,[1,1.5,2.25,3.38,5.06,7.59,11.39,17.09,25.63,38.44,57.67,86.5,129.75,194.62,291.93,437.89,656.84,985.26,1477.89,2216.84,3325.26,4987.89,7481.83]),$t=function(){function t(){this.clear()}var e=t.prototype;return e.clear=function(){return this.counters={},this},e.state=function(){return this.counters},e.track=function(t,e){return void 0===this.counters[t]&&(this.counters[t]=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.counters[t][Zt(e)]++,this},e.isEmpty=function(){return 0===Object.keys(this.counters).length},e.toJSON=function(){return this.counters},t}(),Xt=function(){function t(){this.clear()}var e=t.prototype;return e.clear=function(){return this.counters={},this},e.state=function(){return this.counters},e.track=function(t){return void 0===this.counters[t]?this.counters[t]=1:this.counters[t]++,this.counters[t]},e.isEmpty=function(){return 0===Object.keys(this.counters).length},e.toJSON=function(){return this.counters},t}(),te=function(){function t(t){var e=this,n=t.get(t.constants.SETTINGS),r=t.get(t.constants.EVENTS);this.onFullQueue=!1,this.maxQueue=n.scheduler.eventsQueueSize,this.queue=[],this.queueByteSize=0,s(r)?r.then((function(t){e.onFullQueue=t.flushAndResetTimer,e._checkForFlush()})):"function"===typeof r.flushAndResetTimer&&(this.onFullQueue=r.flushAndResetTimer)}var e=t.prototype;return e.state=function(){return this.queue},e.track=function(t,e){return void 0===e&&(e=0),this.queueByteSize+=e,this.queue.push(t),this._checkForFlush(),!0},e.clear=function(){return this.queue=[],this.queueByteSize=0,this},e.toJSON=function(){return this.queue},e.isEmpty=function(){return 0===this.queue.length},e._checkForFlush=function(){(this.queueByteSize>5242880||this.maxQueue>0&&this.queue.length>=this.maxQueue)&&this.onFullQueue&&this.onFullQueue()},t}(),ee=te,ne=/[^.]+$/,re=/count\.([^/]+)$/,ie=/latency\.([^/]+)\.bucket\.([0-9]+)$/,se=function(){function t(t){this.settings=t}var e=t.prototype;return e.buildSplitKey=function(t){return this.settings.storage.prefix+".split."+t},e.buildTrafficTypeKey=function(t){return this.settings.storage.prefix+".trafficType."+t},e.buildSplitsTillKey=function(){return this.settings.storage.prefix+".splits.till"},e.buildSplitsReady=function(){return this.settings.storage.prefix+".splits.ready"},e.isSplitKey=function(t){return a(t,this.settings.storage.prefix+".split.")},e.buildSegmentNameKey=function(t){return this.settings.storage.prefix+".segment."+t},e.buildSegmentTillKey=function(t){return this.settings.storage.prefix+".segment."+t+".till"},e.buildRegisteredSegmentsKey=function(){return this.settings.storage.prefix+".segments.registered"},e.buildSegmentsReady=function(){return this.settings.storage.prefix+".segments.ready"},e.buildVersionablePrefix=function(){return this.settings.storage.prefix+"/"+this.settings.version+"/"+this.settings.runtime.ip},e.buildImpressionsKey=function(){return this.settings.storage.prefix+".impressions"},e.buildEventsKey=function(){return this.settings.storage.prefix+".events"},e.buildLatencyKeyPrefix=function(){return this.buildVersionablePrefix()+"/latency"},e.buildLatencyKey=function(t,e){return this.buildLatencyKeyPrefix()+"."+t+".bucket."+e},e.buildCountKey=function(t){return this.buildVersionablePrefix()+"/count."+t},e.buildGaugeKey=function(t){return this.buildVersionablePrefix()+"/gauge."+t},e.searchPatternForCountKeys=function(){return this.buildVersionablePrefix()+"/count.*"},e.searchPatternForSplitKeys=function(){return this.settings.storage.prefix+".split.*"},e.searchPatternForLatency=function(){return this.buildLatencyKeyPrefix()+".*"},e.extractKey=function(t){var e=t.match(ne);if(e&&e.length)return e[0];throw new Error("Invalid latency key provided")},e.extractCounterName=function(t){var e=t.match(re);if(e&&e.length)return e[1];throw new Error("Invalid counter key provided")},e.extractLatencyMetricNameAndBucket=function(t){var e=t.match(ie);if(e&&e.length>2)return{metricName:e[1],bucketNumber:e[2]};throw new Error("Invalid counter key provided")},t}(),ae=n(94578);function oe(t,e){return void 0===e&&(e=!1),function(n){return g(n)?n[t]:e?void 0:n}}var ue=oe("matchingKey"),ce=oe("bucketingKey",!0),fe=function(t){function e(e){var n;return(n=t.call(this,e)||this).regexSplitCacheKey=new RegExp("^"+n.settings.storage.prefix+"\\.(splits?|trafficType)\\."),n}(0,ae.Z)(e,t);var n=e.prototype;return n.buildSegmentNameKey=function(t){return this.settings.storage.prefix+"."+ue(this.settings.core.key)+".segment."+t},n.extractSegmentName=function(t){var e=this.settings.storage.prefix+"."+ue(this.settings.core.key)+".segment.";if(a(t,e))return t.substr(e.length)},n.buildSplitsWithSegmentCountKey=function(){return this.settings.storage.prefix+".splits.usingSegments"},n.buildLastUpdatedKey=function(){return this.settings.storage.prefix+".splits.lastUpdated"},n.isSplitCacheKey=function(t){return this.regexSplitCacheKey.test(t)},n.buildSplitsFilterQueryKey=function(){return this.settings.storage.prefix+".splits.filterQuery"},n.buildOldSegmentNameKey=function(t){return ue(this.settings.core.key)+"."+this.settings.storage.prefix+".segment."+t},n.extractOldSegmentKey=function(t){var e=ue(this.settings.core.key)+"."+this.settings.storage.prefix+".segment.";if(a(t,e))return t.substr(e.length)},e}(se),le=function(t){var e=t.get(t.constants.SETTINGS);switch(e.storage.type){case vt:var n=new se(e);return{splits:new zt,segments:new Yt(n),impressions:new Jt,metrics:new $t,count:new Xt,events:new ee(t),shared:function(t){var e=new se(t);return{splits:this.splits,segments:new Yt(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new zt,this.segments.flush()}}},destroy:function(){this.splits.flush(),this.segments.flush(),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};case yt:var r=new fe(e),i=Date.now()-864e6;return{splits:new Bt(r,i,e.sync.__splitFiltersValidation),segments:new Vt(r),impressions:new Jt,metrics:new $t,count:new Xt,events:new ee(t),shared:function(t){var e=new fe(t);return{splits:this.splits,segments:new Vt(e),impressions:this.impressions,metrics:this.metrics,count:this.count,events:this.events,destroy:function(){this.splits=new zt,this.segments=new Yt(e)}}},destroy:function(){this.splits=new zt,this.segments=new Yt(new se(e)),this.impressions.clear(),this.metrics.clear(),this.count.clear(),this.events.clear()}};default:throw new Error("Unsupported storage type")}},he=n(17187),pe=n.n(he),ge="init::timeout",de="init::ready",me="init::cache-ready",ve="state::splits-arrived",ye="state::segments-arrived",Se="state::splits-cache-loaded",Te="state::update",Ee="state::check";var be=function(){var t=0,e=new(pe());e.SDK_SPLITS_CACHE_LOADED=Se,e.SDK_SPLITS_ARRIVED=ve;var n=0;return function(r){void 0===r&&(r=0);var i=0,s=new(pe());s.SDK_SEGMENTS_ARRIVED=ye;var a=function(e,n){var r=new(pe()),i=0,s=0;return r.on(Ee,(function(){14!==s&&t+i===6?(s=14,r.emit(de)):14===s&&r.emit(Te)})),e.on(ve,(function(e){e||(t=2),r.emit(Ee)})),e.once(Se,(function(){try{r.emit(me)}catch(t){setTimeout((function(){throw t}),0)}})),n.on(ye,(function(){i=4,r.emit(Ee)})),r}(e,s);return r>0&&(i=setTimeout((function(){a.emit(ge,"Split SDK emitted SDK_READY_TIMED_OUT event.")}),r),a.once(de,(function(){return clearTimeout(i)}))),a.SDK_READY=de,a.SDK_READY_FROM_CACHE=me,a.SDK_UPDATE=Te,a.SDK_READY_TIMED_OUT=ge,n++,{splits:e,segments:s,gate:a,destroy:function(){s.removeAllListeners(),a.removeAllListeners(),clearTimeout(i),n>0&&n--,0===n&&e.removeAllListeners()}}}};var _e={startup:{requestTimeoutBeforeReady:5,retriesOnFailureBeforeReady:1,readyTimeout:10,eventsFirstPushWindow:10}},Ae=x("splitio-settings"),Ne=function(t){var e,n=t.mode,r=t.storage,i=r.type,s=void 0===i?vt:i,a=r.options,o=void 0===a?{}:a,u=r.prefix;u?u+=".SPLITIO":u="SPLITIO";var c=function(){e=s,s=vt};return n===pt&&s===yt&&c(),(s!==vt&&s!==yt||s===yt&&!w())&&(c(),Ae.warn("Invalid or unavailable storage. Fallbacking into MEMORY storage")),{type:s,options:o,prefix:u,__originalType:e}},Re=x("splitio-settings"),we=function(t,e){void 0===e&&(e=[]);var n=t.integrations;if(!Array.isArray(n)||0===n.length)return[];var r=n.filter((function(t){return t&&f(t.type)&&e.indexOf(t.type)>-1})),i=n.length-r.length;return i&&Re.warn(i+" integration "+(1===i?"item":"items")+" at settings "+(1===i?"is":"are")+" invalid: integration items must have a valid 'type' value"),r},Ce=function(t){return we(t,[Et,bt])};var ke=function(t,e){if("localhost"===t)return pt;if(-1===[gt,dt,mt].indexOf(e))throw Error("Invalid mode provided");return e},Oe=x("splitio-settings");function Ie(t,e){var n={validFilters:[],queryString:null,groupedFilters:{byName:[],byPrefix:[]}};return t?e!==gt?(Oe.warn("split filters have been configured but will have no effect if mode is not '"+gt+"', since synchronization is being deferred to an external tool."),n):Array.isArray(t)&&0!==t.length?(n.validFilters=t.filter((function(t,e){return t&&(r=t.type,Nt.some((function(t){return t.type===r})))&&Array.isArray(t.values)?(n.groupedFilters[t.type]=n.groupedFilters[t.type].concat(t.values),!0):(Oe.warn("split filter at position '"+e+"' is invalid. It must be an object with a valid filter type ('byName' or 'byPrefix') and a list of 'values'."),!1);var r})),Nt.forEach((function(t){var e=t.type,r=t.maxLength;n.groupedFilters[e].length>0&&(n.groupedFilters[e]=function(t,e,n){var r=ht(e,"settings",t+" filter",t+" filter value");if(r){if(r.length>n)throw new Error(n+" unique values can be specified at most for '"+t+"' filter. You passed "+r.length+". Please consider reducing the amount or using other filter.");r.sort()}return r||[]}(e,n.groupedFilters[e],r))})),n.queryString=function(t){var e=[];return Nt.forEach((function(n){var r=n.type,i=n.queryParam,s=t[r];s.length>0&&e.push(i+s.map((function(t){return encodeURIComponent(t)})).join(","))})),e.length>0?"&"+e.join("&"):null}(n.groupedFilters),Oe.debug("splits filtering criteria is '"+n.queryString+"'."),n):(Oe.warn("splitFilters configuration must be a non-empty array of filter objects."),n):n}var De=x("splitio-settings");var Me=function(t){return t=t.toUpperCase(),-1===[Rt,wt].indexOf(t)&&(De.error("You passed an invalid impressionsMode, impressionsMode should be one of the following values: '"+Rt+"' or '"+wt+"'. Defaulting to '"+wt+"' mode."),t=wt),t},Ke=/^\/(testImpressions|metrics|events)/,Pe=/^\/v2\/auth/,xe=/^\/(sse|event-stream)/,Le={mode:gt,core:{authorizationKey:void 0,key:void 0,trafficType:void 0,labelsEnabled:!0,IPAddressesEnabled:void 0},scheduler:{featuresRefreshRate:30,segmentsRefreshRate:60,metricsRefreshRate:120,impressionsRefreshRate:60,offlineRefreshRate:15,eventsPushRate:60,eventsQueueSize:500,pushRetryBackoffBase:1},urls:{sdk:"https://sdk.split.io/api",events:"https://events.split.io/api",auth:"https://auth.split.io/api",streaming:"https://streaming.split.io"},storage:{type:vt},debug:void 0,impressionListener:void 0,version:"javascript-10.17.3",integrations:void 0,streamingEnabled:!0,sync:{splitFilters:void 0,impressionsMode:wt}};function Fe(t){return Math.round(1e3*t)}function Ge(t){var e,n=d({},Le,_e,t);n.scheduler.featuresRefreshRate=Fe(n.scheduler.featuresRefreshRate),n.scheduler.segmentsRefreshRate=Fe(n.scheduler.segmentsRefreshRate),n.scheduler.metricsRefreshRate=Fe(n.scheduler.metricsRefreshRate),n.scheduler.impressionsRefreshRate=Fe(n.scheduler.impressionsRefreshRate),n.scheduler.offlineRefreshRate=Fe(n.scheduler.offlineRefreshRate),n.scheduler.eventsPushRate=Fe(n.scheduler.eventsPushRate),n.startup.requestTimeoutBeforeReady=Fe(n.startup.requestTimeoutBeforeReady),n.startup.readyTimeout=Fe(n.startup.readyTimeout),n.startup.eventsFirstPushWindow=Fe(n.startup.eventsFirstPushWindow),n.mode=ke(n.core.authorizationKey,n.mode),n.storage=Ne(n),"boolean"===typeof(e=n.debug)?e?P.enable():P.disable():"string"===typeof e&&P.setLogLevel(e),n.runtime=(n.core.IPAddressesEnabled,n.mode,{ip:!1,hostname:!1}),n.integrations=Ce(n),!1!==n.streamingEnabled&&(n.streamingEnabled=!0,n.scheduler.pushRetryBackoffBase=Fe(n.scheduler.pushRetryBackoffBase));var r=Ie(n.sync.splitFilters,n.mode);return n.sync.splitFilters=r.validFilters,n.sync.__splitFiltersValidation=r,n.sync.impressionsMode=Me(n.sync.impressionsMode),n}var Ue={url:function(t){return Ke.test(t)?""+this.urls.events+t:Pe.test(t)?""+this.urls.auth+t:xe.test(t)?""+this.urls.streaming+t:""+this.urls.sdk+t},overrideKeyAndTT:function(t,e){return i()(Object.create(Ue),this,{core:i()({},this.core,{key:t,trafficType:e})})}},je=function(t){return i()(Object.create(Ue),Ge(t))},ze={COLLECTORS:"metrics_collectors",DESTROYED:"is_destroyed",EVENTS:"events_publisher",HAS_TIMEDOUT:"has_timedout",INTEGRATIONS_MANAGER:"integrations_manager",MY_SEGMENTS_CHANGE_WORKER:"my_segments_change_worker",PRODUCER:"producer",READINESS:"readiness_gate",READY:"is_ready",READY_FROM_CACHE:"is_ready_from_cache",SETTINGS:"settings",STATUS_MANAGER:"status_manager",STORAGE:"storage",IMPRESSIONS_COUNTER:"impressions_counter"},We=function(){function t(){this._map={},this.constants=ze}var e=t.prototype;return e.get=function(t,e){if(void 0===e&&(e=!1),"string"===typeof t&&("string"!==typeof t||t.length)){var n=this._map[t];if(void 0!==n)return n;if(!e){var r,i=new Promise((function(t){return r=t}));return i.manualResolve=r,this._map[t]=i,i}}},e.getAll=function(){return i()({},this._map)},e.put=function(t,e){var n=this;if("string"!==typeof t||"string"===typeof t&&!t.length||void 0===e)return!1;var r=this._map[t];return(void 0===r||"function"===typeof r.manualResolve)&&(s(r)&&r.manualResolve&&r.manualResolve(e),s(e)&&e.then((function(e){return n._map[t]=e,e})).catch((function(e){return n._map[t]=void 0,e})),this._map[t]=e,!0)},t}(),He=function(t){return g(t)?{matchingKey:t.matchingKey,bucketingKey:t.bucketingKey}:{matchingKey:t,bucketingKey:t}};var Be="object"===typeof performance&&"function"===typeof performance.now?performance.now.bind(performance):Date.now;var Ye,qe=function(){var t=Be();return function(){return Math.round(Be()-t)}},Ve=new R("[TIME TRACKER]",{showLevel:!1}),Je={},Qe={SDK_READY:"Getting ready - Split SDK",SDK_GET_TREATMENT:"SDK - Get Treatment",SDK_GET_TREATMENTS:"SDK - Get Treatments",SDK_GET_TREATMENT_WITH_CONFIG:"SDK - Get Treatment with config",SDK_GET_TREATMENTS_WITH_CONFIG:"SDK - Get Treatments with config",SPLITS_READY:"Getting ready - Splits",SEGMENTS_READY:"Getting ready - Segments",METRICS_PUSH:"Pushing - Metrics",IMPRESSIONS_PUSH:"Pushing - Impressions",EVENTS_PUSH:"Pushing - Events",MY_SEGMENTS_FETCH:"Fetching - My Segments",SEGMENTS_FETCH:"Fetching - Segments",SPLITS_FETCH:"Fetching - Splits"},Ze=((Ye={})[Qe.SDK_READY]={collector:"client",method:"ready"},Ye[Qe.SDK_GET_TREATMENT]={collector:"client",method:"getTreatment"},Ye[Qe.SDK_GET_TREATMENTS]={collector:"client",method:"getTreatments"},Ye[Qe.SDK_GET_TREATMENT_WITH_CONFIG]={collector:"client",method:"getTreatmentWithConfig"},Ye[Qe.SDK_GET_TREATMENTS_WITH_CONFIG]={collector:"client",method:"getTreatmentsWithConfig"},Ye[Qe.MY_SEGMENTS_FETCH]={collector:"mySegments",method:"latency"},Ye[Qe.SEGMENTS_FETCH]={collector:"segmentChanges",method:"latency"},Ye[Qe.SPLITS_FETCH]={collector:"splitChanges",method:"latency"},Ye),$e=function(t,e){return"string"===typeof e?t+e:t},Xe=function(t,e){var n=Ze[t];return!(!n||!e)&&e[n.collector]},tn=function(t,e){var n=Ze[t];return!(!n||!e)&&e[n.method]},en={__attachToPromise:function(t,e,n,r){var i=this;return t.then((function(t){return i.stop(e,r),n&&n.count&&n.count(t.status),t})).catch((function(t){throw i.stop(e,r),n&&n.countException&&n.countException(),t}))},start:function(t,e,n){var r,i=p++,a=Xe(t,e);s(n)?r=this.__attachToPromise(n,t,a,i):(r=this.stop.bind(this,t,i),Ze[t]&&!a&&(r.setCollectorForTask=this.setCollectorForTask.bind(this,t,i)));var o=$e(t,i),u=tn(t,a);return Je[o]={cb:u,timer:qe()},r},setCollectorForTask:function(t,e,n){var r=Xe(t,n);if(r){var i=$e(t,e);Je[i].cb=tn(t,r)}},stop:function(t,e){var n=$e(t,e),r=Je[n];if(r){var i=r.timer();return Ve.debug("["+t+"] took "+i+"ms to finish."),r.cb&&r.cb(i),delete Je[n],i}},TaskNames:Qe},nn=en,rn={UNDEFINED:0,ALL_KEYS:1,IN_SEGMENT:2,WHITELIST:3,EQUAL_TO:4,GREATER_THAN_OR_EQUAL_TO:5,LESS_THAN_OR_EQUAL_TO:6,BETWEEN:7,EQUAL_TO_SET:8,CONTAINS_ANY_OF_SET:9,CONTAINS_ALL_OF_SET:10,PART_OF_SET:11,ENDS_WITH:12,STARTS_WITH:13,CONTAINS_STRING:14,IN_SPLIT_TREATMENT:15,EQUAL_TO_BOOLEAN:16,MATCHES_STRING:17},sn="BOOLEAN",an="STRING",on="NUMBER",un="SET",cn="DATETIME",fn="NOT_SPECIFIED";var ln=function(t){return void 0===t&&(t={}),t.segmentName},hn=n(43144),pn=function(){function t(){var t=this;this.__setData__=[];var e=arguments[0];Array.isArray(e)&&e.forEach((function(e){t.add(e)}))}var e=t.prototype;return e.clear=function(){this.__setData__.length&&(this.__setData__.length=0)},e.add=function(t){return this.has(t)||this.__setData__.push(t),this},e.delete=function(t){var e=this.__setData__.indexOf(t);return-1!==e&&(this.__setData__.splice(e,1),!0)},e.has=function(t){return-1!==this.__setData__.indexOf(t)},e.forEach=function(t){var e=arguments[1];if("function"!==typeof t)throw new TypeError(t+" is not a function");for(var n=0;n<this.__setData__.length;n++){var r=this.__setData__[n];t.call(e,r,r,this)}},(0,hn.Z)(t,[{key:"size",get:function(){return this.__setData__.length}}]),t}();function gn(t){return t instanceof pn?t.__setData__.slice():Array.from(t)}var dn="function"===typeof Array.from&&"function"===typeof Set&&Set.prototype&&Set.prototype.values?Set:pn;var mn=function(t){return new dn(t.whitelist)};var vn=function(t){return t.whitelist};var yn=function(t){return t.value};function Sn(t){return new Date(t).setUTCHours(0,0,0,0)}function Tn(t){return new Date(t).setUTCSeconds(0,0)}var En=function(t){var e=t.map((function(t){var e=t.matcherType,n=t.negate,r=t.keySelector,i=t.userDefinedSegmentMatcherData,s=t.whitelistMatcherData,a=t.unaryNumericMatcherData,o=t.betweenMatcherData,u=t.dependencyMatcherData,c=t.booleanMatcherData,f=t.stringMatcherData,l=r&&r.attribute,h=function(t){return rn[t]||rn.UNDEFINED}(e),p=an,g=void 0;return h===rn.IN_SEGMENT?g=ln(i):h===rn.WHITELIST?g=mn(s):h===rn.EQUAL_TO?(g=yn(a),p=on,"DATETIME"===a.dataType&&(g=Sn(g),p=cn)):h===rn.GREATER_THAN_OR_EQUAL_TO||h===rn.LESS_THAN_OR_EQUAL_TO?(g=yn(a),p=on,"DATETIME"===a.dataType&&(g=Tn(g),p=cn)):h===rn.BETWEEN?(g=o,p=on,"DATETIME"===o.dataType&&(g.start=Tn(g.start),g.end=Tn(g.end),p=cn)):h===rn.EQUAL_TO_SET||h===rn.CONTAINS_ANY_OF_SET||h===rn.CONTAINS_ALL_OF_SET||h===rn.PART_OF_SET?(g=vn(s),p=un):h===rn.STARTS_WITH||h===rn.ENDS_WITH||h===rn.CONTAINS_STRING?g=vn(s):h===rn.IN_SPLIT_TREATMENT?(g=u,p=fn):h===rn.EQUAL_TO_BOOLEAN?(p=sn,g=c):h===rn.MATCHES_STRING&&(g=f),{attribute:l,negate:n,type:h,value:g,dataType:p}}));return-1===u(e,(function(t){return t.type===rn.UNDEFINED}))?e:[]};function bn(t,e){if(!(this instanceof bn))return new bn(t,e);if(100!==t[t.length-1])throw new RangeError("Provided invalid dataset as input");this._ranges=t,this._treatments=e}bn.parse=function(t){var e=t.reduce((function(t,e){var n=e.size,r=e.treatment;return t.ranges.push(t.inc+=n),t.treatments.push(r),t}),{inc:0,ranges:[],treatments:[]});return new bn(e.ranges,e.treatments)},bn.prototype.getTreatmentFor=function(t){if(t<0||t>100)throw new RangeError("Please provide a value between 0 and 100");var e=u(this._ranges,(function(e){return t<=e}));return this._treatments[e]};var _n=bn,An=x("splitio-engine:matcher");function Nn(t){return An.debug("[allMatcher] is always true"),null!=t}var Rn=function(){return Nn},wn=x("splitio-engine:matcher");var Cn=function(t,e){return function(n){var r=e.segments.isInSegment(t,n);return s(r)?r.then((function(e){return wn.debug("[asyncSegmentMatcher] evaluated "+t+" / "+n+" => "+r),e})):wn.debug("[segmentMatcher] evaluated "+t+" / "+n+" => "+r),r}},kn=x("splitio-engine:matcher");var On=function(t){return function(e){var n=t.has(e);return kn.debug("[whitelistMatcher] evaluated "+e+" in ["+gn(t).join(",")+"] => "+n),n}},In=x("splitio-engine:matcher");var Dn=function(t){return function(e){var n=e===t;return In.debug("[equalToMatcher] is "+e+" equal to "+t+"? "+n),n}},Mn=x("splitio-engine:matcher");var Kn=function(t){return function(e){var n=e>=t;return Mn.debug("[greaterThanEqualMatcher] is "+e+" greater than "+t+"? "+n),n}},Pn=x("splitio-engine:matcher");var xn=function(t){return function(e){var n=e<=t;return Pn.debug("[lessThanEqualMatcher] is "+e+" less than "+t+"? "+n),n}},Ln=x("splitio-engine:matcher");var Fn=function(t){return function(e){var n=e>=t.start&&e<=t.end;return Ln.debug("[betweenMatcher] is "+e+" between "+t.start+" and "+t.end+"? "+n),n}},Gn=x("splitio-engine:matcher");var Un=function(t){return function(e){for(var n=e.length===t.length,r=function(r){u(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return Gn.debug("[equalToSetMatcher] is "+e+" equal to set "+t+"? "+n),n}},jn=x("splitio-engine:matcher");var zn=function(t){return function(e){var n=!0;if(e.length<t.length)n=!1;else for(var r=function(r){u(e,(function(e){return e===t[r]}))<0&&(n=!1)},i=0;i<t.length&&n;i++)r(i);return jn.debug("[containsAllMatcher] "+e+" contains all elements of "+t+"? "+n),n}},Wn=x("splitio-engine:matcher");var Hn=function(t){return function(e){for(var n=!1,r=function(r){u(e,(function(e){return e===t[r]}))>=0&&(n=!0)},i=0;i<t.length&&!n;i++)r(i);return Wn.debug("[containsAnyMatcher] "+e+" contains at least an element of "+t+"? "+n),n}},Bn=x("splitio-engine:matcher");var Yn=function(t){return function(e){for(var n=e.length<=t.length,r=function(r){u(t,(function(t){return t===e[r]}))<0&&(n=!1)},i=0;i<e.length&&n;i++)r(i);return Bn.debug("[partOfMatcher] "+e+" is part of "+t+"? "+n),n}},qn=x("splitio-engine:matcher");var Vn=function(t){return function(e){var n=t.some((function(t){return a(e,t)}));return qn.debug("[startsWithMatcher] "+e+" starts with "+t+"? "+n),n}},Jn=x("splitio-engine:matcher");var Qn=function(t){return function(e){var n=t.some((function(t){return r=t,void 0===i&&(i=!1),!(!f(n=e)||!f(r))&&(i&&(n=n.toLowerCase(),r=r.toLowerCase()),n.slice(n.length-r.length)===r);var n,r,i}));return Jn.debug("[endsWithMatcher] "+e+" ends with "+t+"? "+n),n}},Zn=x("splitio-engine:matcher");var $n=function(t){return function(e){var n=t.some((function(t){return f(e)&&e.indexOf(t)>-1}));return Zn.debug("[containsStringMatcher] "+e+" contains "+t+"? "+n),n}},Xn=x("splitio-engine:matcher");function tr(t,e,n){var r=!1;return Array.isArray(e)&&(r=-1!==e.indexOf(t.treatment)),Xn.debug('[dependencyMatcher] Parent split "'+n+'" evaluated to "'+t.treatment+'" with label "'+t.label+'". '+n+" evaluated treatment is part of ["+e+"] ? "+r+"."),r}var er=function(t,e){var n=t.split,r=t.treatments;return function(t,i){var a=t.key,o=t.attributes;Xn.debug('[dependencyMatcher] will evaluate parent split: "'+n+'" with key: '+JSON.stringify(a)+" "+(o?"\n attributes: "+JSON.stringify(o):""));var u=i(a,n,o,e);return s(u)?u.then((function(t){return tr(t,r,n)})):tr(u,r,n)}},nr=x("splitio-engine:matcher");var rr=function(t){return function(e){var n=t===e;return nr.debug("[booleanMatcher] "+t+" === "+e),n}},ir=x("splitio-engine:matcher");var sr=[void 0,Rn,Cn,On,Dn,Kn,xn,Fn,Un,Hn,zn,Yn,Qn,Vn,$n,er,rr,function(t){return function(e){var n;try{n=new RegExp(t)}catch(i){return ir.debug("[stringMatcher] "+t+" is an invalid regex"),!1}var r=n.test(e);return ir.debug("[stringMatcher] does "+e+" matches with "+t+"? "+(r?"yes":"no")),r}}];var ar=function(t,e){var n,r=t.type,i=t.value;return sr[r]&&(n=sr[r](i,e)),n},or=x("splitio-engine:sanitize");function ur(t,e){return{key:t,attributes:e}}var cr=function(t,e,n,r){var i,s=function(t,e){switch(t){case rn.EQUAL_TO:return"DATETIME"===e?Sn:void 0;case rn.GREATER_THAN_OR_EQUAL_TO:case rn.LESS_THAN_OR_EQUAL_TO:case rn.BETWEEN:return"DATETIME"===e?Tn:void 0;case rn.IN_SPLIT_TREATMENT:return ur;default:return}}(t,n);switch(n){case on:case cn:i=function(t){var e=y(t);return isNaN(e)?void 0:e}(e);break;case an:i=function(t){var e=t;return g(t)&&(e=t.matchingKey?t.matchingKey:void 0),v(e)||void 0}(e);break;case un:i=function(t){var e=Array.isArray(t)?m(t.map((function(t){return t+""}))):[];return e.length?e:void 0}(e);break;case sn:i=function(t){if(!0===t||!1===t)return t;if("string"===typeof t){var e=t.toLocaleLowerCase();if("true"===e)return!0;if("false"===e)return!1}}(e);break;case fn:i=e;break;default:i=void 0}return s&&(i=s(i,r)),or.debug("Attempted to sanitize ["+e+"] which should be of type ["+n+"]. \n Sanitized and processed value => ["+(i instanceof Object?JSON.stringify(i):i)+"]"),i},fr=x("splitio-engine:value");var lr=function(t,e,n){var r=e.attribute,i=function(t,e,n){var r=void 0;return e?n?(r=n[e],fr.debug("Extracted attribute ["+e+"], ["+r+"] will be used for matching.")):fr.warn("Defined attribute ["+e+"], no attributes received."):r=t,r}(t,r,n),s=cr(e.type,i,e.dataType,n);return void 0!==s?s:void fr.warn("Value "+i+" "+(r?"for attribute "+r+" ":0)+"doesn't match with expected type.")};function hr(t){return e=function(t){return(t=Number(t))<0?Math.ceil(t):Math.floor(t)}(t),n=Math.pow(2,32),e-Math.floor(e/n)*n;var e,n}function pr(t){var e=hr(t);return e>=Math.pow(2,31)?e-Math.pow(2,32):e}function gr(t,e){for(var n=0,r=0;r<t.length;r++)n=pr(pr(31*n)+t.charCodeAt(r));return pr(n^e)}var dr=function(t,e){return Math.abs(gr(t,e)%100)+1};var mr=String.fromCharCode;function vr(t){var e,n,r;return n=function(t){if("string"!==typeof t)throw TypeError("Illegal argument: "+typeof t);var e=0;return function(){return e>=t.length?null:t.charCodeAt(e++)}}(t),r=e=function(){var t=[],e=[];return function(){if(0===arguments.length)return e.join("")+mr.apply(String,t);t.length+arguments.length>1024&&(e.push(mr.apply(String,t)),t.length=0),Array.prototype.push.apply(t,arguments)}}(),function(t,e){for(var n,r=null;null!==(n=null!==r?r:t());)n>=55296&&n<=57343&&null!==(r=t())&&r>=56320&&r<=57343?(e(1024*(n-55296)+r-56320+65536),r=null):e(n);null!==r&&e(r)}(n,(function(t){!function(t,e){var n=null;for("number"===typeof t&&(n=t,t=function(){return null});null!==n||null!==(n=t());)n<128?e(127&n):n<2048?(e(n>>6&31|192),e(63&n|128)):n<65536?(e(n>>12&15|224),e(n>>6&63|128),e(63&n|128)):(e(n>>18&7|240),e(n>>12&63|128),e(n>>6&63|128),e(63&n|128)),n=null}(t,r)})),e()}function yr(t,e){return(65535&t)*e+(((t>>>16)*e&65535)<<16)}function Sr(t,e){return t<<e|t>>>32-e}function Tr(t,e){e=e||0;for(var n,r=(t=t||"").length%4,i=t.length-r,s=e,a=0,o=3432918353,u=461845907,c=0;c<i;c+=4)a=yr(a=255&t.charCodeAt(c)|(255&t.charCodeAt(c+1))<<8|(255&t.charCodeAt(c+2))<<16|(255&t.charCodeAt(c+3))<<24,o),a=yr(a=Sr(a,15),u),s=yr(s=Sr(s^=a,13),5)+3864292196;switch(a=0,r){case 3:a^=(255&t.charCodeAt(c+2))<<16;case 2:a^=(255&t.charCodeAt(c+1))<<8;case 1:a=yr(a^=255&t.charCodeAt(c),o),s^=a=yr(a=Sr(a,15),u)}return s^=t.length,n=s,n=yr(n^=n>>>16,2246822507),(s=(n=yr(n^=n>>>13,3266489909))^n>>>16)>>>0}function Er(t,e){return Tr(vr(t),e>>>0)}var br={hash:Er,bucket:function(t,e){return Math.abs(Er(t,e)%100)+1}},_r=x("splitio-engine");function Ar(t){return 2===t?br.bucket:dr}var Nr={getTreatment:function(t,e,n,r){var i=Ar(r)(t,e),s=n.getTreatmentFor(i);return _r.debug("[engine] using algo "+(2!==r?"legacy":"murmur")+" bucket "+i+" for key "+t+" using seed "+e+" - treatment "+s),s},shouldApplyRollout:function(t,e,n,r){if(t<100&&Ar(r)(e,n)>t)return!1;return!0}},Rr=Nr;function wr(t,e,n,r,i,s){if(t)return{treatment:Rr.getTreatment(e,n,r,s),label:i}}var Cr=function(t,e,n,r){return function(i,a,o,u,c,f,l){if("ROLLOUT"===r&&!Rr.shouldApplyRollout(o,i.bucketingKey,u,l))return{treatment:void 0,label:"not in split"};var h=t(i,f,c);return s(h)?h.then((function(t){return wr(t,i.bucketingKey,a,e,n,l)})):wr(h,i.bucketingKey,a,e,n,l)}},kr=x("splitio-engine:combiner");function Or(){return kr.error("Invalid Split provided, no valid conditions found"),{treatment:St,label:at}}function Ir(t){for(var e=t.length,n=0;n<e;n++){var r=t[n];if(void 0!==r)return kr.debug("Treatment found: "+r.treatment),r}kr.debug("All predicates evaluated, no treatment found.")}var Dr=function(t){return!Array.isArray(t)||Array.isArray(t)&&0===t.length?Or:function(e,n,r,i,a,o,c){var f=t.map((function(t){return t(e,n,r,i,c,a,o)}));return-1!==u(f,s)?Promise.all(f).then((function(t){return Ir(t)})):Ir(f)}},Mr=x("splitio-engine:combiner");function Kr(t){for(var e,n=0,r=t.length;n<r&&t[n];n++);return e=n===r,Mr.debug("[andCombiner] evaluates to "+e),e}var Pr=function(t){return function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t.map((function(t){return t.apply(void 0,n)}));return-1!==u(i,s)?Promise.all(i).then(Kr):Kr(i)}};var xr=function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r],a=i.matcherGroup.matchers,o=i.partitions,u=i.label,c=i.conditionType,f=(a=En(a)).map((function(t){var n=ar(t,e);return function(e,r,i){var a=lr(e,t,r),o=void 0!==a&&n(a,i);return s(o)?o.then((function(e){return Boolean(e^t.negate)})):Boolean(o^t.negate)}}));if(0===f.length){n=[];break}n.push(Cr(Pr(f),_n.parse(o),u,c))}return Dr(n)};function Lr(t,e){return{treatment:o(t,"treatment",e),label:o(t,"label","default rule")}}function Fr(t,e){if(!(this instanceof Fr))return new Fr(t,e);var n;this.baseInfo=t,this.evaluator=e,"string"!==typeof(n=this).baseInfo.defaultTreatment&&(n.baseInfo.defaultTreatment=St)}Fr.parse=function(t,e){var n=t.conditions,r=xr(n,e);return new Fr(i()({},t),r)},Fr.prototype.getKey=function(){return this.baseInfo.name},Fr.prototype.getTreatment=function(t,e,n){var r,i,a,o=this.baseInfo,u=o.killed,c=o.seed,f=o.defaultTreatment,l=o.trafficAllocation,h=o.trafficAllocationSeed,p=o.algo;try{r=He(t)}catch(d){return{treatment:St,label:at}}if(this.isGarbage())i=St,a="archived";else{if(!u){var g=this.evaluator(r,c,l,h,e,p,n);return s(g)?g.then((function(t){return Lr(t,f)})):Lr(g,f)}i=f,a="killed"}return{treatment:i,label:a}},Fr.prototype.isGarbage=function(){return"ARCHIVED"===this.baseInfo.status},Fr.prototype.getChangeNumber=function(){return this.baseInfo.changeNumber};var Gr=Fr,Ur={treatment:St,label:at,config:null};function jr(t,e,n,r){var i;try{i=r.splits.getSplit(e)}catch(a){return Promise.resolve(Ur)}return s(i)?i.then((function(e){return zr(e,t,n,r)})):zr(i,t,n,r)}function zr(t,e,n,r){var i={treatment:St,label:st,config:null};if(t){var a=JSON.parse(t),o=Gr.parse(a,r);if(i=o.getTreatment(e,n,jr),s(i))return i.then((function(t){return t.changeNumber=o.getChangeNumber(),t.config=a.configurations&&a.configurations[t.treatment]||null,t}));i.changeNumber=o.getChangeNumber(),i.config=a.configurations&&a.configurations[i.treatment]||null}return i}function Wr(t,e,n,r,i){var a={},o=[];return t.forEach((function(t){var u=zr(e[t],n,r,i);s(u)?o.push(u.then((function(e){a[t]=e}))):a[t]=u})),o.length>0?Promise.all(o).then((function(){return a})):a}var Hr=function(t,e,n,r){this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null},Br=function(){function t(){this.tail=null,this.head=null,this.length=0}var e=t.prototype;return e.removeNode=function(t){if(t&&t instanceof Hr){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e}},e.unshiftNode=function(t){if(t&&t instanceof Hr&&t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},e.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)this.head=new Hr(arguments[t],null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},t}(),Yr="undefined"!==typeof Map?Map:function(){function t(){}var e=t.prototype;return e.set=function(t,e){this[t]=e},e.get=function(t){return this[t]},e.delete=function(t){delete this[t]},(0,hn.Z)(t,[{key:"size",get:function(){return Object.keys(this).length}}]),t}(),qr=function(){function t(t){this.maxLen=t||1,this.items=new Yr,this.lru=new Br}var e=t.prototype;return e.get=function(t){var e=this.items.get(t);if(e&&e instanceof Hr)return this.lru.unshiftNode(e),e.value.value},e.set=function(t,e){var n=this.items.get(t);if(n){if(!(n instanceof Hr))return!1;this.lru.unshiftNode(n),this.lru.head.value.value=e}else{if(this.lru.length===this.maxLen){var r=this.lru.tail;if(!r)return!1;this.items.delete(r.value.key),this.lru.removeNode(this.lru.tail)}this.lru.unshift({key:t,value:e}),this.items.set(t,this.lru.head)}return!0},t}(),Vr=qr,Jr=function(){function t(t,e){this.cache=new Vr(t),this.hasher=e}return t.prototype.testAndSet=function(t){var e=this.hasher(t),n=this.cache.get(e);return this.cache.set(e,t.time),n},t}(),Qr=Jr;function Zr(t){return br.hash(function(t){return t.keyName+":"+t.feature+":"+t.treatment+":"+t.label+":"+t.changeNumber}(t))}var $r=function(){return new Qr(500,Zr)};function Xr(t){return t-t%36e5}var ti=x("splitio-client:impressions-tracker");function ei(t){return[dt,gt].indexOf(t.mode)>-1}var ni=function(t){var e=t.get(t.constants.STORAGE).impressions,n=t.get(t.constants.SETTINGS),r=n.impressionListener,a=t.get(t.constants.INTEGRATIONS_MANAGER,!0),o=n.runtime,u=o.ip,c=o.hostname,f=n.version,l=[],h=ei(n),p=function(t){return!!ei(t)&&t.sync.impressionsMode===wt}(n),g=$r(),d=t.get(t.constants.IMPRESSIONS_COUNTER);return{queue:function(t,e){l.push({impression:t,attributes:e})},track:function(){var t=l.length,n=l.splice(0,t),o=[];n.forEach((function(t){var e=t.impression;h&&(e.pt=g.testAndSet(e));var n=Date.now();p&&d&&d.inc(e.feature,n,1),(!p||!e.pt||e.pt<Xr(n))&&o.push(e)}));var m=e.track(o);if(s(m)&&m.then((function(){ti.debug("Successfully stored "+t+" impression"+(1===t?"":"s")+".")})).catch((function(e){ti.error("Could not store impressions bulk with "+t+" impression"+(1===t?"":"s")+". Error: "+e)})),r||a)for(var v=function(t){var e={impression:i()({},n[t].impression),attributes:n[t].attributes,ip:u,hostname:c,sdkLanguageVersion:f};setTimeout((function(){a&&a.handleImpression(e);try{r&&r.logImpression(e)}catch(t){ti.error("Impression listener logImpression method threw: "+t+".")}}),0)},y=0;y<t;y++)v(y)}}},ri=x("splitio-client:event-tracker");var ii=function(t){var e=t.get(t.constants.STORAGE).events,n=t.get(t.constants.INTEGRATIONS_MANAGER,!0);function r(t,e){var r='event of type "'+t.eventTypeId+'" for traffic type "'+t.trafficTypeName+'". Key: '+t.key+". Value: "+t.value+". Timestamp: "+t.timestamp+". "+(t.properties?"With properties.":"With no properties.");return e?(ri.info("Successfully queued "+r),n&&setTimeout((function(){var e=i()({},t);t.properties&&(e.properties=i()({},t.properties)),n.handleEvent(e)}),0)):ri.warn("Failed to queue "+r),e}return{track:function(t,n){var i=e.track(t,n);return s(i)?i.then(r.bind(null,t)):r(t,i)}}},si=x("splitio-client");var ai=function(t){var e=t.get(t.constants.STORAGE),n=t.get(t.constants.COLLECTORS),r=ni(t),i=ii(t);function a(t,i,a,o){void 0===o&&(o=!1);var c=nn.TaskNames[o?"SDK_GET_TREATMENT_WITH_CONFIG":"SDK_GET_TREATMENT"],f=nn.start(c,n),l=jr(t,i,a,e),h=function(e){var n=u(e,i,t,a,o,"getTreatment"+(o?"withConfig":""));return r.track(),f(),n};return s(l)?l.then((function(t){return h(t)})):h(l)}function o(t,i,a,o){void 0===o&&(o=!1);var c=nn.TaskNames[o?"SDK_GET_TREATMENTS_WITH_CONFIG":"SDK_GET_TREATMENTS"],f=nn.start(c,n),l=function(e){var n={};return Object.keys(e).forEach((function(r){n[r]=u(e[r],r,t,a,o,"getTreatments"+(o?"withConfig":""))})),r.track(),f(),n},h=function(t,e,n,r){var i,a={};try{i=r.splits.fetchMany(e)}catch(o){return e.forEach((function(t){a[t]=Ur})),Promise.resolve(a)}return s(i)?i.then((function(i){return Wr(e,i,t,n,r)})):Wr(e,i,t,n,r)}(t,i,a,e);return s(h)?h.then((function(t){return l(t)})):l(h)}function u(e,n,i,s,a,o){var u=t.get(t.constants.READY,!0)||t.get(t.constants.READY_FROM_CACHE,!0),c=ue(i),f=ce(i);u||(e={treatment:St,label:"not ready"});var l=e,h=l.treatment,p=l.label,g=l.changeNumber,d=l.config,m=void 0===d?null:d;return si.info("Split: "+n+". Key: "+c+". Evaluation: "+h+". Label: "+p),ft(t,n,p,o)&&(si.info("Queueing corresponding impression."),r.queue({feature:n,keyName:c,treatment:h,time:Date.now(),bucketingKey:f,label:p,changeNumber:g},s)),a?{treatment:h,config:m}:h}return{getTreatment:a,getTreatmentWithConfig:function(t,e,n){return a(t,e,n,!0)},getTreatments:o,getTreatmentsWithConfig:function(t,e,n){return o(t,e,n,!0)},track:function(e,n,r,a,o,u){void 0===a&&(a=null),void 0===o&&(o=null),void 0===u&&(u=1024);var c=ue(e),f={eventTypeId:r,trafficTypeName:n,value:a,timestamp:Date.now(),key:c,properties:o};return function(t,e,n){var r=e.get(e.constants.READY,!0),i=e.get(e.constants.SETTINGS),a=e.get(e.constants.STORAGE).splits;if(!r||i.mode===pt)return!0;var o=a.trafficTypeExists(t);s(o)?o.then((function(e){return e||It(n,t),e})):o||It(n,t)}(n,t,"track"),i.track(f,u)}}};var oi=function(t,e,n){var r="REDIS"!==t.get(t.constants.SETTINGS).storage.type,s=ai(t),o=s.getTreatment,u=s.getTreatmentWithConfig,c=s.getTreatments,f=s.getTreatmentsWithConfig,l=s.track;function h(n,r,i,s){var o=a(s,"getTreatments"),u=e?n:it(n,s),c=o?ht(r,s):ct(r,s),f=z(i,s),l=Mt(t);return Kt(t,s),{valid:l&&u&&c&&!1!==f,key:u,splitOrSplits:c,attributes:f}}return s.getTreatment=function(t,e,n){var i=h(t,e,n,"getTreatment");return i.valid?o(i.key,i.splitOrSplits,i.attributes):r?St:Promise.resolve(St)},s.getTreatmentWithConfig=function(t,e,n){var s=h(t,e,n,"getTreatmentWithConfig");return s.valid?u(s.key,s.splitOrSplits,s.attributes):r?i()({},Tt):Promise.resolve(i()({},Tt))},s.getTreatments=function(t,e,n){var i=h(t,e,n,"getTreatments");if(i.valid)return c(i.key,i.splitOrSplits,i.attributes);var s={};return i.splitOrSplits&&i.splitOrSplits.forEach((function(t){return s[t]=St})),r?s:Promise.resolve(s)},s.getTreatmentsWithConfig=function(t,e,n){var s=h(t,e,n,"getTreatmentsWithConfig");if(s.valid)return f(s.key,s.splitOrSplits,s.attributes);var a={};return s.splitOrSplits&&s.splitOrSplits.forEach((function(t){return a[t]=i()({},Tt)})),r?a:Promise.resolve(a)},s.track=function(i,s,a,o,u){var c=e?i:it(i,"track"),f=n?s:Ot(s,"track"),h=Y(a,"track"),p=V(o,"track"),g=et(u,"track"),d=g.properties,m=g.size;return Mt(t)&&c&&f&&h&&!1!==p&&!1!==d?l(c,f,h,p,d,m):!r&&Promise.resolve(!1)},s},ui=function(){function t(){this.attributesCache={}}var e=t.prototype;return e.setAttribute=function(t,e){return this.attributesCache[t]=e,!0},e.getAttribute=function(t){return this.attributesCache[t]},e.setAttributes=function(t){return this.attributesCache=i()(this.attributesCache,t),!0},e.getAll=function(){return this.attributesCache},e.removeAttribute=function(t){return Object.keys(this.attributesCache).indexOf(t)>=0&&(delete this.attributesCache[t],!0)},e.clear=function(){return this.attributesCache={},!0},t}(),ci=x("splitio-client");var fi=function(t){var e,n=t.get(t.constants.SETTINGS),r=o(n,"core.key",void 0),s=o(n,"core.trafficType",void 0);n.mode===pt&&void 0===r?n.core.key="localhost_key":n.core.key=it(r,"Client instantiation");var a=[n.core.key];if(void 0!==s){var u=Ot(s,"Client instantiation");n.core.trafficType=u,a.push(u)}var c=function(t,e,n){var r=oi(t,e,n),s=new ui,a=r.getTreatment,o=r.getTreatmentWithConfig,u=r.getTreatments,c=r.getTreatmentsWithConfig;function f(t){var e=s.getAll();return Object.keys(e).length>0?i()({},e,t):t}return r.setAttribute=function(t,e){var n={};return n[t]=e,!!W(n)&&(ci.debug("stored "+e+" for attribute "+t),s.setAttribute(t,e))},r.getAttribute=function(t){return ci.debug("retrieved attribute "+t),s.getAttribute(t+"")},r.setAttributes=function(t){return!!W(t)&&s.setAttributes(t)},r.getAttributes=function(){return s.getAll()},r.removeAttribute=function(t){return ci.debug("removed attribute "+t),s.removeAttribute(t+"")},r.clearAttributes=function(){return s.clear()},r.getTreatment=function(t,e,n){return a(t,e,f(n))},r.getTreatmentWithConfig=function(t,e,n){return o(t,e,f(n))},r.getTreatments=function(t,e,n){return u(t,e,f(n))},r.getTreatmentsWithConfig=function(t,e,n){return c(t,e,f(n))},r}(t,!0,a.length>1);return c.isBrowserClient=!0,c.getTreatment=c.getTreatment.bind(c,n.core.key),c.getTreatmentWithConfig=c.getTreatmentWithConfig.bind(c,n.core.key),c.getTreatments=c.getTreatments.bind(c,n.core.key),c.getTreatmentsWithConfig=c.getTreatmentsWithConfig.bind(c,n.core.key),c.track=(e=c.track).bind.apply(e,[c].concat(a)),c};var li=function(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var s,a=!1;function o(n){void 0===n&&(n=e);for(var r=arguments.length,i=new Array(r>1?r-1:0),u=1;u<r;u++)i[u-1]=arguments[u];a||(s=setTimeout((function(){t.apply(void 0,i.concat([o]))}),n))}function u(){clearTimeout(s),s=void 0,a=!0}return u.reset=function(){clearTimeout(s),s=void 0,o.apply(void 0,[e].concat(r))},t.apply(void 0,r.concat([o])),u},hi=n(63144),pi=n.n(hi);function gi(){return"function"===typeof fetch?fetch:pi()}var di=n(61120),mi=n(89611);function vi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yi(t,e,n){return yi=vi()?Reflect.construct:function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&(0,mi.Z)(i,n.prototype),i},yi.apply(null,arguments)}function Si(t){var e="function"===typeof Map?new Map:void 0;return Si=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!==typeof t)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return yi(t,arguments,(0,di.Z)(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),(0,mi.Z)(r,t)},Si(t)}var Ti=function(t){function e(e){var n;return void 0===e&&(e="Split Error"),(n=t.call(this,e)||this).message=e,n}return(0,ae.Z)(e,t),e}(Si(Error)),Ei=function(t){function e(e){return t.call(this,e||"Split Timeout Error")||this}return(0,ae.Z)(e,t),e}(Ti),bi=function(t){function e(e,n){var r;return(r=t.call(this,e||"Split Network Error")||this).statusCode=n,r}return(0,ae.Z)(e,t),e}(Ti),_i=x("splitio-services:service");function Ai(t){var e=t.url,n=gi();return n?n(e,t).then((function(t){return t.ok?t:t.text().then((function(e){return Promise.reject({response:t,message:e})}))})).catch((function(n){var r=n&&n.response,i="";if(r)if(404===r.status)i="Invalid API key or resource not found.";else i=n.message;else i=n.message;throw r&&403===r.status||_i[t.logErrorsAsInfo?"info":"error"]("Response status is not OK. Status: "+(r?r.status:"NO_STATUS")+". URL: "+e+". Message: "+i),new bi(i,r&&r.status)})):Promise.reject(new bi("Global fetch API is not available."))}var Ni=Ai;var Ri=function(t,e,n,r){var s=t.core.authorizationKey,a=t.version,o=t.runtime,u=o.ip,c=o.hostname,f={},l={};return f.Accept="application/json",f["Content-Type"]="application/json",f.Authorization="Bearer "+s,f.SplitSDKVersion=a,u&&(f.SplitSDKMachineIP=u),c&&(f.SplitSDKMachineName=c),r&&i()(f,r),i()({headers:f,url:t.url(e)},l,n)},wi={"Cache-Control":"no-cache"};function Ci(t){var e=[];return S(t.toJSON(),(function(t,n){e.push({name:n,latencies:t})})),e}function ki(t){var e=[];return S(t.toJSON(),(function(t,n){e.push({name:n,delta:t})})),e}var Oi=Ai;function Ii(t,e){return Ri(t,"/testImpressions/bulk",i()({method:"POST"},e),{SplitSDKImpressionsMode:t.sync.impressionsMode===wt?wt:Rt})}function Di(t,e){return Ri(t,"/testImpressions/count",i()({method:"POST"},e))}function Mi(t,e){var n=e.core.labelsEnabled,r=function(t,e){var n={};if(Array.isArray(t)&&f(e))for(var r=0;r<t.length;r++){var i=t[r][e];f(i)&&(n[i]||(n[i]=[]),n[i].push(t[r]))}return n}(t.state(),"feature"),i=[];return S(r,(function(t,e){i.push({f:e,i:t.map((function(t){var e={k:t.keyName,t:t.treatment,m:t.time,c:t.changeNumber};return n&&(e.r=t.label),t.bucketingKey&&(e.b=t.bucketingKey),t.pt&&(e.pt=t.pt),e}))})})),i}function Ki(t){var e=[];if(0===(t?t.size():0))return e;for(var n=t.popAll(),r=Object.keys(n),i=0;i<r.length;i++){var s=r[i].split("::");if(2===s.length){var a=s[0],o=s[1],u={f:a,m:Number(o),rc:n[r[i]]};e.push(u)}}return e}var Pi=function(){function t(t){this.storage=t,this.latency=this.latency.bind(this),this.count=this.count.bind(this),this.countException=this.countException.bind(this)}var e=t.prototype;return e.latency=function(t){this.storage.metrics.track(this.metricType+".time",t)},e.count=function(t){this.storage.count.track(this.metricType+".status."+t)},e.countException=function(){this.storage.count.track(this.metricType+".exception")},t}(),xi=function(t){function e(e){var n;return(n=t.call(this,e)||this).metricType="segmentChangeFetcher",n}return(0,ae.Z)(e,t),e}(Pi),Li=function(t){function e(e){var n;return(n=t.call(this,e)||this).metricType="splitChangeFetcher",n}return(0,ae.Z)(e,t),e}(Pi),Fi=function(t){function e(e){var n;return(n=t.call(this,e)||this).metricType="mySegmentsFetcher",n}return(0,ae.Z)(e,t),e}(Pi),Gi=function(){function t(t){this.storage=t,this.ready=this.ready.bind(this),this.getTreatment=this.getTreatment.bind(this),this.getTreatments=this.getTreatments.bind(this),this.getTreatmentWithConfig=this.getTreatmentWithConfig.bind(this),this.getTreatmentsWithConfig=this.getTreatmentsWithConfig.bind(this)}var e=t.prototype;return e.ready=function(t){this.storage.metrics.track("sdk.ready",t)},e.getTreatment=function(t){this.storage.metrics.track("sdk.getTreatment",t)},e.getTreatments=function(t){this.storage.metrics.track("sdk.getTreatments",t)},e.getTreatmentWithConfig=function(t){this.storage.metrics.track("sdk.getTreatmentWithConfig",t)},e.getTreatmentsWithConfig=function(t){this.storage.metrics.track("sdk.getTreatmentsWithConfig",t)},t}(),Ui=x("splitio-metrics"),ji=function(t){var e=0,n=t.get(t.constants.SETTINGS),r=t.get(t.constants.STORAGE),s=t.get(t.constants.IMPRESSIONS_COUNTER),a=n.sync.impressionsMode===wt,o=function(){if(r.metrics.isEmpty()&&r.count.isEmpty())return Promise.resolve();Ui.debug("Pushing metrics");var t=nn.start(nn.TaskNames.METRICS_PUSH),e=r.metrics.isEmpty()?null:Ni(function(t,e){return Ri(t,"/metrics/times",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify(Ci(r.metrics))})).then((function(){return r.metrics.clear()})).catch((function(){return r.metrics.clear()})),s=r.count.isEmpty()?null:Ni(function(t,e){return Ri(t,"/metrics/counters",i()({method:"POST"},e,{logErrorsAsInfo:!0}))}(n,{body:JSON.stringify(ki(r.count))})).then((function(){return r.count.clear()})).catch((function(){return r.count.clear()}));return Promise.all([e,s]).then((function(e){return t(),e}))},u=function(){if(r.impressions.isEmpty())return Promise.resolve();var t=r.impressions.queue.length;Ui.info("Pushing "+t+" impressions");var i=nn.start(nn.TaskNames.IMPRESSIONS_PUSH);return Oi(Ii(n,{body:JSON.stringify(Mi(r.impressions,n))})).then((function(){e=0,r.impressions.clear()})).catch((function(n){e?(Ui.warn("Droping "+t+" impressions after retry. Reason "+n+"."),e=0,r.impressions.clear()):(e++,Ui.warn("Failed to push "+t+" impressions, keeping data to retry on next iteration. Reason "+n+"."))})).then((function(){return i()}))},c=function(){var t=Ki(s),r=t.length;return 0===r?Promise.resolve():(Ui.info("Pushing count of impressions for "+r+" features"),Oi(Di(n,{body:JSON.stringify({pf:t})})).then((function(){e=0})).catch((function(t){e?(Ui.warn("Droping count of impressions for "+r+" features after retry. Reason "+t+"."),e=0):(e++,Ui.warn("Failed to push impressions count for "+r+" features, keeping data to retry on next iteration. Reason "+t+"."))})))},f=!1,l=!1,h=!1;return{start:function(){f=li((function(t){return u().then((function(){return t()}))}),n.scheduler.impressionsRefreshRate),l=li((function(t){return o().then((function(){return t()}))}),n.scheduler.metricsRefreshRate),a&&(h=li((function(t){return c().then((function(){return t()}))}),18e5))},flush:function(){return a&&c(),u()},stop:function(){f&&f(),l&&l(),h&&h()},collectors:{segmentChanges:new xi(r),splitChanges:new Li(r),mySegments:new Fi(r),client:new Gi(r)}}},zi=Ai;function Wi(t,e){return Ri(t,"/events/bulk",i()({method:"POST"},e))}var Hi=x("splitio-events"),Bi=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE),r=function(){if(n.events.isEmpty())return Promise.resolve();Hi.info("Pushing "+n.events.state().length+" queued events.");var t=nn.start(nn.TaskNames.EVENTS_PUSH),r=JSON.stringify(n.events.toJSON()),i=function(){return t()};return n.events.clear(),zi(Wi(e,{body:r})).then(i).catch(i)},i=!1,s=!1,a=function(){return s=li((function(t){return r().then((function(){return t()}))}),e.scheduler.eventsPushRate)};return{start:function(){e.startup.eventsFirstPushWindow>0?i=setTimeout(a,e.startup.eventsFirstPushWindow):a()},flush:function(){return r()},stop:function(){i&&clearTimeout(i),s&&s()},flushAndResetTimer:function(){return Hi.info("Flushing events and reseting timer."),s&&s.reset(),r()}}},Yi=Ai;function qi(t){return"users="+encodeURIComponent(t)}function Vi(t){return atob(t)}function Ji(t,e){var n=Yi(function(t,e){var n="/v2/auth";if(e){var r=e.map(qi).join("&");r&&(n+="?"+r)}return Ri(t,n)}(t,e));return n.then((function(t){return t.json()})).then((function(t){if(t.token){var e=function(t){var e=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(Vi(e).split("").map((function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)}(t.token);if("number"!==typeof e.iat||"number"!==typeof e.exp)throw new Error('token properties "issuedAt" (iat) or "expiration" (exp) are missing or invalid');var n=JSON.parse(e["x-ably-capability"]);return i()({decodedToken:e,channels:n},t)}return t}))}function Qi(){return"function"===typeof EventSource?EventSource:void 0}var Zi=function(){function t(e,n,r){this.baseMillis=n||t.DEFAULT_BASE_MILLIS,this.maxMillis=r||t.DEFAULT_MAX_MILLIS,this.attempts=0,this.cb=e}var e=t.prototype;return e.scheduleCall=function(){var t=this,e=Math.min(this.baseMillis*Math.pow(2,this.attempts),this.maxMillis);return this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=setTimeout((function(){t.cb()}),e),this.attempts++,e},e.reset=function(){this.attempts=0,this.timeoutID&&(clearTimeout(this.timeoutID),this.timeoutID=0)},t}();Zi.DEFAULT_BASE_MILLIS=1e3,Zi.DEFAULT_MAX_MILLIS=18e5;var $i=Zi,Xi=function(){function t(t,e){this.mySegmentsStorage=t,this.mySegmentsProducer=e,this.maxChangeNumber=0,this.segmentsData=void 0,this.currentChangeNumber=-1,this.put=this.put.bind(this),this.__handleMySegmentUpdateCall=this.__handleMySegmentUpdateCall.bind(this),this.backoff=new $i(this.__handleMySegmentUpdateCall)}var e=t.prototype;return e.__handleMySegmentUpdateCall=function(){var t=this;if(this.maxChangeNumber>this.currentChangeNumber){this.handleNewEvent=!1;var e=this.maxChangeNumber;this.mySegmentsProducer.synchronizeMySegments(this.segmentsData,!0).then((function(n){!1!==n&&(t.currentChangeNumber=Math.max(t.currentChangeNumber,e)),t.handleNewEvent?t.__handleMySegmentUpdateCall():t.backoff.scheduleCall()}))}},e.put=function(t,e){t<=this.currentChangeNumber||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.segmentsData=e,this.mySegmentsProducer.isSynchronizingMySegments()||this.__handleMySegmentUpdateCall())},t}(),ts=function(){function t(t,e,n){this.splitStorage=t,this.splitProducer=e,this.maxChangeNumber=0,this.splitsEventEmitter=n,this.put=this.put.bind(this),this.killSplit=this.killSplit.bind(this),this.__handleSplitUpdateCall=this.__handleSplitUpdateCall.bind(this),this.backoff=new $i(this.__handleSplitUpdateCall)}var e=t.prototype;return e.__handleSplitUpdateCall=function(){var t=this;this.maxChangeNumber>this.splitStorage.getChangeNumber()&&(this.handleNewEvent=!1,this.splitProducer.synchronizeSplits(!0).then((function(){t.handleNewEvent?t.__handleSplitUpdateCall():(t.splitProducer.synchronizeSegment&&t.splitProducer.synchronizeSegment(void 0,!1,!0),t.backoff.scheduleCall())})))},e.put=function(t){t<=this.splitStorage.getChangeNumber()||t<=this.maxChangeNumber||(this.maxChangeNumber=t,this.handleNewEvent=!0,this.backoff.reset(),this.splitProducer.isSynchronizingSplits()||this.__handleSplitUpdateCall())},e.killSplit=function(t,e,n){var r=this;this.splitStorage.killLocally(e,n,t).then((function(e){e&&r.splitsEventEmitter.emit(r.splitsEventEmitter.SDK_SPLITS_ARRIVED,!0),r.put(t)}))},t}(),es=/^control_/;var ns=function(){function t(t,e,n){this.EventSource=t,this.streamingUrl=e.url("/sse"),this.useHeaders=n,this.headers=function(t){var e={SplitSDKClientKey:t.core.authorizationKey.slice(-4),SplitSDKVersion:t.version},n=t.runtime,r=n.ip,i=n.hostname;return r&&(e.SplitSDKMachineIP=r),i&&(e.SplitSDKMachineName=i),e}(e)}t.getInstance=function(e,n){var r=Qi();if(r)return new t(r,e,n)};var e=t.prototype;return e.setEventHandler=function(t){this.handler=t},e.open=function(t){this.close();var e=Object.keys(t.channels).map((function(t){var e=es.test(t)?"[?occupancy=metrics.publishers]":"";return encodeURIComponent(e+t)})).join(","),n=this.streamingUrl+"?channels="+e+"&accessToken="+t.token+"&v=1.1&heartbeats=true";this.connection=new this.EventSource(this.useHeaders?n:n+"&SplitSDKVersion="+this.headers.SplitSDKVersion+"&SplitSDKClientKey="+this.headers.SplitSDKClientKey,this.useHeaders?{headers:this.headers}:void 0),this.handler&&(this.connection.onopen=this.handler.handleOpen,this.connection.onmessage=this.handler.handleMessage,this.connection.onerror=this.handler.handleError)},e.close=function(){this.connection&&this.connection.close()},t}(),rs="PUSH_NONRETRYABLE_ERROR",is="PUSH_RETRYABLE_ERROR",ss="PUSH_SUBSYSTEM_UP",as="PUSH_SUBSYSTEM_DOWN",os="MY_SEGMENTS_UPDATE",us="MY_SEGMENTS_UPDATE_V2",cs="SEGMENT_UPDATE",fs="SPLIT_KILL",ls="SPLIT_UPDATE",hs="CONTROL",ps="OCCUPANCY",gs="STREAMING_DISABLED",ds="STREAMING_PAUSED",ms="STREAMING_RESUMED",vs="STREAMING_RESET";var ys=[/control_pri$/,/control_sec$/];var Ss=x("splitio-sync:sse-handler");function Ts(t){var e=function(t){var e=ys.map((function(t){return{regex:t,hasPublishers:!0,oTime:-1,cTime:-1}})),n=!0,r=!0;return{handleOpen:function(){t.emit(ss)},isStreamingUp:function(){return r&&n},handleOccupancyEvent:function(i,s,a){for(var o=0;o<e.length;o++){var u=e[o];if(u.regex.test(s)){if(a>u.oTime){u.oTime=a,u.hasPublishers=0!==i;var c=e.some((function(t){return t.hasPublishers}));r&&(!c&&n?t.emit(as):c&&!n&&t.emit(ss)),n=c}return}}},handleControlEvent:function(i,s,a){if(i!==vs)for(var o=0;o<e.length;o++){var u=e[o];if(u.regex.test(s))return void(a>u.cTime&&(u.cTime=a,i===gs?t.emit(rs):n&&(i===ds&&r?t.emit(as):i!==ms||r||t.emit(ss)),r=i===ms))}else t.emit(i)}}}(t);return{handleOpen:function(){e.handleOpen()},handleError:function(e){var n=e;try{n=function(t){return f(t.data)&&(t.parsedData=JSON.parse(t.data)),t}(e)}catch(i){Ss.warn("Error parsing SSE error notification: "+i)}var r=n.parsedData&&n.parsedData.message;Ss.error("Fail to connect to streaming"+(r?', with error message: "'+r+'"':"")),!function(t){if(t.parsedData&&t.parsedData.code){var e=t.parsedData.code;if(40140<=e&&e<=40149)return!0;if(4e4<=e&&e<=49999)return!1}return!0}(n)?t.emit(rs):t.emit(is)},handleMessage:function(n){var r;try{r=function(t){var e=JSON.parse(t.data);return e.parsedData=JSON.parse(e.data),e.name&&"[meta]occupancy"===e.name&&(e.parsedData.type=ps),e}(n)}catch(c){return void Ss.warn("Error parsing new SSE message notification: "+c)}var i=r,s=i.parsedData,a=i.data,o=i.channel,u=i.timestamp;if(Ss.debug("New SSE message received, with data: "+a+"."),e.isStreamingUp()||-1!==[ps,hs].indexOf(s.type))switch(s.type){case ls:t.emit(ls,s.changeNumber);break;case cs:t.emit(cs,s.changeNumber,s.segmentName);break;case os:t.emit(os,s,o);break;case us:t.emit(us,s);break;case fs:t.emit(fs,s.changeNumber,s.splitName,s.defaultTreatment);break;case ps:e.handleOccupancyEvent(s.metrics.publishers,o,u);break;case hs:e.handleControlEvent(s.controlType,o,u)}}}}function Es(t){return function(t){return btoa(t)}(br.hash(t,0).toString())}var bs=function(){if([typeof Uint8Array,typeof Uint16Array,typeof Uint32Array].some((function(t){return"function"!=t})))return"global Uint8Array object is not available for gzip/zlib decompression";var t=Uint8Array,e=Uint16Array,n=Uint32Array,r=new t([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),i=new t([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),s=new t([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),a=function(t,r){for(var i=new e(31),s=0;s<31;++s)i[s]=r+=1<<t[s-1];var a=new n(i[30]);for(s=1;s<30;++s)for(var o=i[s];o<i[s+1];++o)a[o]=o-i[s]<<5|s;return[i,a]},o=a(r,2),u=o[0],c=o[1];u[28]=258,c[258]=28;for(var f=a(i,0)[0],l=new e(32768),h=0;h<32768;++h){var p=(43690&h)>>>1|(21845&h)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,l[h]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(t,n,r){for(var i=t.length,s=0,a=new e(n);s<i;++s)++a[t[s]-1];var o,u=new e(n);for(s=0;s<n;++s)u[s]=u[s-1]+a[s-1]<<1;if(r){o=new e(1<<n);var c=15-n;for(s=0;s<i;++s)if(t[s])for(var f=s<<4|t[s],h=n-t[s],p=u[t[s]-1]++<<h,g=p|(1<<h)-1;p<=g;++p)o[l[p]>>>c]=f}else for(o=new e(i),s=0;s<i;++s)t[s]&&(o[s]=l[u[t[s]-1]++]>>>15-t[s]);return o},d=new t(288);for(h=0;h<144;++h)d[h]=8;for(h=144;h<256;++h)d[h]=9;for(h=256;h<280;++h)d[h]=7;for(h=280;h<288;++h)d[h]=8;var m=new t(32);for(h=0;h<32;++h)m[h]=5;var v=g(d,9,1),y=g(m,5,1),S=function(t){for(var e=t[0],n=1;n<t.length;++n)t[n]>e&&(e=t[n]);return e},T=function(t,e,n){var r=e/8|0;return(t[r]|t[r+1]<<8)>>(7&e)&n},E=function(t,e){var n=e/8|0;return(t[n]|t[n+1]<<8|t[n+2]<<16)>>(7&e)},b=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],_=function t(e,n,r){var i=new Error(n||b[e]);if(i.code=e,Error.captureStackTrace&&Error.captureStackTrace(i,t),!r)throw i;return i},A=function(a,o,c){var l=a.length;if(!l||c&&c.f&&!c.l)return o||new t(0);var h=!o||c,p=!c||c.i;c||(c={}),o||(o=new t(3*l));var d=function(e){var n=o.length;if(e>n){var r=new t(Math.max(2*n,e));r.set(o),o=r}},m=c.f||0,b=c.p||0,A=c.b||0,N=c.l,R=c.d,w=c.m,C=c.n,k=8*l;do{if(!N){m=T(a,b,1);var O=T(a,b+1,3);if(b+=3,!O){var I=a[(z=4+((b+7)/8|0))-4]|a[z-3]<<8,D=z+I;if(D>l){p&&_(0);break}h&&d(A+I),o.set(a.subarray(z,D),A),c.b=A+=I,c.p=b=8*D,c.f=m;continue}if(1==O)N=v,R=y,w=9,C=5;else if(2==O){var M=T(a,b,31)+257,K=T(a,b+10,15)+4,P=M+T(a,b+5,31)+1;b+=14;for(var x=new t(P),L=new t(19),F=0;F<K;++F)L[s[F]]=T(a,b+3*F,7);b+=3*K;var G=S(L),U=(1<<G)-1,j=g(L,G,1);for(F=0;F<P;){var z,W=j[T(a,b,U)];if(b+=15&W,(z=W>>>4)<16)x[F++]=z;else{var H=0,B=0;for(16==z?(B=3+T(a,b,3),b+=2,H=x[F-1]):17==z?(B=3+T(a,b,7),b+=3):18==z&&(B=11+T(a,b,127),b+=7);B--;)x[F++]=H}}var Y=x.subarray(0,M),q=x.subarray(M);w=S(Y),C=S(q),N=g(Y,w,1),R=g(q,C,1)}else _(1);if(b>k){p&&_(0);break}}h&&d(A+131072);for(var V=(1<<w)-1,J=(1<<C)-1,Q=b;;Q=b){var Z=(H=N[E(a,b)&V])>>>4;if((b+=15&H)>k){p&&_(0);break}if(H||_(2),Z<256)o[A++]=Z;else{if(256==Z){Q=b,N=null;break}var $=Z-254;if(Z>264){var X=r[F=Z-257];$=T(a,b,(1<<X)-1)+u[F],b+=X}var tt=R[E(a,b)&J],et=tt>>>4;tt||_(3),b+=15&tt;q=f[et];if(et>3){X=i[et];q+=E(a,b)&(1<<X)-1,b+=X}if(b>k){p&&_(0);break}h&&d(A+131072);for(var nt=A+$;A<nt;A+=4)o[A]=o[A-q],o[A+1]=o[A+1-q],o[A+2]=o[A+2-q],o[A+3]=o[A+3-q];A=nt}}c.l=N,c.p=Q,c.b=A,c.f=m,N&&(m=1,c.m=w,c.d=R,c.n=C)}while(!m);return A==o.length?o:function(r,i,s){(null==i||i<0)&&(i=0),(null==s||s>r.length)&&(s=r.length);var a=new(r instanceof e?e:r instanceof n?n:t)(s-i);return a.set(r.subarray(i,s)),a}(o,0,A)};return{gunzipSync:function(e,n){return A(e.subarray(function(t){31==t[0]&&139==t[1]&&8==t[2]||_(6,"invalid gzip data");var e=t[3],n=10;4&e&&(n+=t[10]|2+(t[11]<<8));for(var r=(e>>3&1)+(e>>4&1);r>0;r-=!t[n++]);return n+(2&e)}(e),-8),n||new t(function(t){var e=t.length;return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}(e)))},unzlibSync:function(t,e){return A(((8!=(15&(n=t)[0])||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&_(6,"invalid zlib data"),32&n[1]&&_(6,"invalid zlib data: preset dictionaries not supported"),t.subarray(2,-4)),e);var n}}}();function _s(t,e){var n=function(t){var e=t.split("").map((function(t){return t.charCodeAt()}));return new Uint8Array(e)}(Vi(t));if("string"===typeof bs)throw new Error(bs);if(1===e)return bs.gunzipSync(n);if(2===e)return bs.unzlibSync(n);throw new Error("Invalid compression algorithm #"+e)}function As(t,e){var n,r=_s(t,e),i=(n=r,String.fromCharCode.apply(null,n));return JSON.parse(i.replace(/\d+/g,'"$&"'))}function Ns(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]+e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]+e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]+e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]+e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function Rs(t,e){t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]],e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]];var n=[0,0,0,0];return n[3]+=t[3]*e[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=t[2]*e[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=t[3]*e[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=t[1]*e[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[2]*e[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=t[3]*e[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=t[0]*e[3]+t[1]*e[2]+t[2]*e[1]+t[3]*e[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]}function ws(t,e){return 32===(e%=64)?[t[1],t[0]]:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e|t[0]>>>32-e]:(e-=32,[t[1]<<e|t[0]>>>32-e,t[0]<<e|t[1]>>>32-e])}function Cs(t,e){return 0===(e%=64)?t:e<32?[t[0]<<e|t[1]>>>32-e,t[1]<<e]:[t[1]<<e-32,0]}function ks(t,e){return[t[0]^e[0],t[1]^e[1]]}function Os(t){return t=ks(t,[0,t[0]>>>1]),t=ks(t=Rs(t,[4283543511,3981806797]),[0,t[0]>>>1]),t=ks(t=Rs(t,[3301882366,444984403]),[0,t[0]>>>1])}function Is(t,e){return function(t,e){e=e||0;for(var n=(t=t||"").length%16,r=t.length-n,i=[0,e],s=[0,e],a=[0,0],o=[0,0],u=[2277735313,289559509],c=[1291169091,658871167],f=0;f<r;f+=16)a=[255&t.charCodeAt(f+4)|(255&t.charCodeAt(f+5))<<8|(255&t.charCodeAt(f+6))<<16|(255&t.charCodeAt(f+7))<<24,255&t.charCodeAt(f)|(255&t.charCodeAt(f+1))<<8|(255&t.charCodeAt(f+2))<<16|(255&t.charCodeAt(f+3))<<24],o=[255&t.charCodeAt(f+12)|(255&t.charCodeAt(f+13))<<8|(255&t.charCodeAt(f+14))<<16|(255&t.charCodeAt(f+15))<<24,255&t.charCodeAt(f+8)|(255&t.charCodeAt(f+9))<<8|(255&t.charCodeAt(f+10))<<16|(255&t.charCodeAt(f+11))<<24],a=ws(a=Rs(a,u),31),i=Ns(i=ws(i=ks(i,a=Rs(a,c)),27),s),i=Ns(Rs(i,[0,5]),[0,1390208809]),o=ws(o=Rs(o,c),33),s=Ns(s=ws(s=ks(s,o=Rs(o,u)),31),i),s=Ns(Rs(s,[0,5]),[0,944331445]);switch(a=[0,0],o=[0,0],n){case 15:o=ks(o,Cs([0,t.charCodeAt(f+14)],48));case 14:o=ks(o,Cs([0,t.charCodeAt(f+13)],40));case 13:o=ks(o,Cs([0,t.charCodeAt(f+12)],32));case 12:o=ks(o,Cs([0,t.charCodeAt(f+11)],24));case 11:o=ks(o,Cs([0,t.charCodeAt(f+10)],16));case 10:o=ks(o,Cs([0,t.charCodeAt(f+9)],8));case 9:o=Rs(o=ks(o,[0,t.charCodeAt(f+8)]),c),s=ks(s,o=Rs(o=ws(o,33),u));case 8:a=ks(a,Cs([0,t.charCodeAt(f+7)],56));case 7:a=ks(a,Cs([0,t.charCodeAt(f+6)],48));case 6:a=ks(a,Cs([0,t.charCodeAt(f+5)],40));case 5:a=ks(a,Cs([0,t.charCodeAt(f+4)],32));case 4:a=ks(a,Cs([0,t.charCodeAt(f+3)],24));case 3:a=ks(a,Cs([0,t.charCodeAt(f+2)],16));case 2:a=ks(a,Cs([0,t.charCodeAt(f+1)],8));case 1:a=Rs(a=ks(a,[0,t.charCodeAt(f)]),u),i=ks(i,a=Rs(a=ws(a,31),c))}return i=Ns(i=ks(i,[0,t.length]),s=ks(s,[0,t.length])),s=Ns(s,i),i=Ns(i=Os(i),s=Os(s)),s=Ns(s,i),("00000000"+(i[0]>>>0).toString(16)).slice(-8)+("00000000"+(i[1]>>>0).toString(16)).slice(-8)+("00000000"+(s[0]>>>0).toString(16)).slice(-8)+("00000000"+(s[1]>>>0).toString(16)).slice(-8)}(vr(t),e>>>0)}function Ds(t){var e,n,r,i=[0];for(e=0;e<t.length;e+=1){for(r=parseInt(t.charAt(e),16),n=i.length-1;n>=0;n-=1)i[n]=16*i[n]+r,r=i[n]/10|0,i[n]%=10;for(;r>0;)i.unshift(r%10),r=r/10|0}return i.join("")}function Ms(t){var e=Is(t).slice(0,16);return{hex:e,dec:Ds(e)}}var Ks=x("splitio-sync:push-manager");function Ps(t,e){return"Fetching MySegments due to an error processing "+t+" notification: "+e}function xs(t,e){if(function(t){return Qi()?"function"===typeof atob&&"function"===typeof btoa||(t.warn('"atob" and "btoa" functions for Base64 encoding are not available. Falling back to polling mode.'),!1):(t.warn("EventSource API is not available. Falling back to polling mode."),!1)}(Ks)){var n=new(pe()),r=t.get(t.constants.READINESS).splits,s=t.get(t.constants.SETTINGS),a=t.get(t.constants.STORAGE),o=ns.getInstance(s,!e),u=Ts(n);o.setEventHandler(u);var c,f,l,h={},p={},g=!1,d=new $i(T,s.scheduler.pushRetryBackoffBase);n.on(as,b),n.on(ss,(function(){d.reset(),b()})),n.on(rs,(function(){E(),n.emit(as)})),n.on(is,(function(){o.close();var t=d.scheduleCall();Ks.info("Attempting to reconnect in "+t/1e3+" seconds."),n.emit(as)})),n.on(vs,(function(){c||(f&&clearTimeout(f),T())}));var m,v=t.get(t.constants.PRODUCER),y=new ts(a.splits,v,r);return n.on(fs,y.killSplit),n.on(ls,y.put),e?(n.on(os,(function(n,r){var i=r.split("_")[2],s=h[i];if(s&&e[s]){var a=e[s].get(t.constants.MY_SEGMENTS_CHANGE_WORKER,!0);a&&a.put(n.changeNumber,n.includesPayload?n.segmentList?n.segmentList:[]:void 0)}})),n.on(us,(function(t){switch(t.u){case 1:var e;try{s=t.d,a=t.c,e=_s(s,a)}catch(o){Ks.warn(Ps("BoundedFetchRequest",o));break}return void S(p,(function(n){var r=n.hash64,i=n.worker;(function(t,e){var n=parseInt(e.slice(8),16)%(8*t.length),r=n%8;return(t[Math.floor(n/8)]&1<<r)>0})(e,r.hex)&&i.put(t.changeNumber)}));case 2:var n,r,i;try{n=As(t.d,t.c),r=new dn(n.a),i=new dn(n.r)}catch(o){Ks.warn(Ps("KeyList",o));break}return void S(p,(function(e){var n=e.hash64,s=e.worker,a=!!r.has(n.dec)||!i.has(n.dec)&&void 0;void 0!==a&&s.put(t.changeNumber,{name:t.segmentName,add:a})}));case 3:if(!t.segmentName){Ks.warn(Ps("SegmentRemoval","No segment name was provided"));break}return void S(p,(function(e){e.worker.put(t.changeNumber,{name:t.segmentName,add:!1})}))}var s,a;S(p,(function(e){e.worker.put(t.changeNumber)}))}))):(m=new Xi(a.segments,v),n.on(cs,m.put)),i()(Object.create(n),{stop:E,start:T,startNewClient:function(t,e){var n=Es(t),r=e.get(e.constants.STORAGE),i=e.get(e.constants.PRODUCER);h[n]||(h[n]=t,g=!0);var s=new Xi(r.segments,i);p[t]={worker:s,hash64:Ms(t)},e.put(e.constants.MY_SEGMENTS_CHANGE_WORKER,s),setTimeout((function(){g&&(g=!1,T())}),0)},removeClient:function(t){var e=Es(t);delete h[e],delete p[t]}})}function T(){if(!c){Ks.info((void 0===c?"Connecting":"Re-connecting")+" to push streaming."),c=!1;var t=e?Object.keys(e):void 0;Ji(s,t).then((function(r){if(!c)return r.pushEnabled?void(t&&t.length<Object.keys(e).length||function(t){f&&clearTimeout(f),l&&clearTimeout(l);var e=t.decodedToken,n=e.exp-e.iat-600,r="number"===typeof t.connDelay&&t.connDelay>=0?t.connDelay:60;Ks.info("Refreshing streaming token in "+n+" seconds, and connecting streaming in "+r+" seconds"),f=setTimeout(T,1e3*n),l=setTimeout((function(){c||o.open(t)}),1e3*r)}(r)):(Ks.info("Streaming is not available. Switching to polling mode."),void n.emit(rs))})).catch((function(t){c||(Ks.error("Failed to authenticate for streaming. Error: "+t.message+"."),t.statusCode>=400&&t.statusCode<500?n.emit(rs):n.emit(is))}))}}function E(){c||(c=!0,o.close(),Ks.info("Disconnecting from push streaming."),f&&clearTimeout(f),l&&clearTimeout(l),d.reset(),b())}function b(){y.backoff.reset(),m&&m.backoff.reset(),S(p,(function(t){return t.worker.backoff.reset()}))}}var Ls=x("splitio-producer:task"),Fs=function(t,e){var n,r=(n=t).name?n.name:(n.toString().match(/function (.+?)\(/)||["",""])[1],i=!1;return{start:function(){i||(Ls.debug("Starting "+r+" refreshing each "+e),i=li((function(e){Ls.debug("Running "+r),t().then((function(){return e()}))}),e))},stop:function(){Ls.debug("Stopping "+r),i&&i(),i=!1},isRunning:function(){return!!i}}};var Gs=function(t,e){return t<1?e:new Promise((function(n,r){var i=setTimeout((function(){r(new Ei("Operation timed out because it exceeded the configured time limit of "+t+"ms."))}),t);e.then((function(t){clearTimeout(i),n(t)}),(function(t){clearTimeout(i),r(t)}))}))},Us=Ai;var js=function(t,e,n,r,i,s){void 0===n&&(n=!1);var a=t.sync.__splitFiltersValidation.queryString,o=Us(function(t,e,n,r){return Ri(t,"/splitChanges?since="+e+(n||""),void 0,r?wi:void 0)}(t,e,a,s)),u=n||i;return o=nn.start(nn.TaskNames.SPLITS_FETCH,!!u&&r,o),n&&(o=Gs(t.startup.requestTimeoutBeforeReady,o)),o.then((function(t){return t.json().catch((function(t){throw new Ti(t.message)}))}))},zs=function(t){var e=new dn;return t.forEach((function(t){t.matcherGroup.matchers.forEach((function(t){var n=t.matcherType,r=t.userDefinedSegmentMatcherData;"IN_SEGMENT"===n&&e.add(r.segmentName)}))})),e},Ws=x("splitio-producer:split-changes");function Hs(t,e){void 0===e&&(e=!1);var n=t.getAll(),r=n[t.constants.SETTINGS],i=n[t.constants.READINESS],a=n[t.constants.STORAGE],o=n[t.constants.COLLECTORS],u=i.splits,c=!0,f=!0;return function t(n,i){void 0===n&&(n=0);var l=a.splits.getChangeNumber();return(s(l)?l:Promise.resolve(l)).then((function(s){Ws.debug("Spin up split update using since = "+s);var l=js(r,s,c,o,e,i).then((function(t){c=!1;var n=function(t){var e=t.reduce((function(t,e){return"ACTIVE"===e.status?(t.added.push([e.name,JSON.stringify(e)]),zs(e.conditions).forEach((function(e){t.segments.add(e)}))):t.removed.push(e.name),t}),{added:[],removed:[],segments:new dn});return e.segments=gn(e.segments),e}(t.splits);return Ws.debug("New splits "+n.added.length),Ws.debug("Removed splits "+n.removed.length),Ws.debug("Segment names collected "+n.segments),Promise.all([a.splits.setChangeNumber(t.till),a.splits.addSplits(n.added),a.splits.removeSplits(n.removed),a.segments.registerSegments(n.segments)]).then((function(){var n;(f||s!==t.till&&(!e||(n=a.segments).getRegisteredSegments().every((function(t){return-1!==n.getChangeNumber(t)}))))&&(f=!1,u.emit(u.SDK_SPLITS_ARRIVED))}))})).catch((function(e){return e instanceof Ti||(setTimeout((function(){throw e}),0),c=!1),Ws.warn("Error while doing fetch of Splits. "+e),c&&r.startup.retriesOnFailureBeforeReady>n?(n+=1,Ws.info("Retrying download of splits #"+n+". Reason: "+e),t(n,i)):(c=!1,!1)}));return c&&a.splits.checkCache()&&u.emit(u.SDK_SPLITS_CACHE_LOADED),l}))}}var Bs=Ai;var Ys=function(t,e,n,r){void 0===e&&(e=!1);var i=Bs(function(t,e){return Ri(t,"/mySegments/"+encodeURIComponent(ue(t.core.key)),void 0,e?wi:void 0)}(t,r));return i=nn.start(nn.TaskNames.MY_SEGMENTS_FETCH,!!e&&n,i),e&&(i=Gs(t.startup.requestTimeoutBeforeReady,i)),i.then((function(t){return t.json().catch((function(t){throw new Ti(t.message)}))})).then((function(t){return t.mySegments.map((function(t){return t.name}))}))},qs=x("splitio-producer:my-segments");var Vs=x("splitio-producer:mySegmentsHandler"),Js=function(t){var e=t.get(t.constants.SETTINGS),n=t.get(t.constants.STORAGE).splits,r=t.get(t.constants.READINESS),i=r.splits,s=r.segments,a=function(t){var e=t.getAll(),n=e[t.constants.SETTINGS],r=e[t.constants.READINESS],i=e[t.constants.STORAGE],s=e[t.constants.COLLECTORS],a=r.segments,o=!0,u=!0;function c(t){var e,n=i.segments;if(Array.isArray(t))e=n.resetSegments(t);else{var r=t.name,s=t.add;n.isInSegment(r)!==s?(e=!0,s?n.addToSegment(r):n.removeFromSegment(r)):e=!1}i.splits.usesSegments()&&(e||o)&&(o=!1,a.emit(a.SDK_SEGMENTS_ARRIVED))}return function t(e,r,i){var a;return void 0===e&&(e=0),a=r?new Promise((function(t){c(r),t()})):Ys(n,u,s,i).then((function(t){u=!1,c(t)})),a.catch((function(r){return r instanceof Ti||setTimeout((function(){throw r}),0),u&&n.startup.retriesOnFailureBeforeReady>e?(e+=1,qs.warn("Retrying download of segments #"+e+". Reason: "+r),t(e)):(u=!1,!1)}))}}(t),o=Fs(c,e.scheduler.segmentsRefreshRate);i.on(i.SDK_SPLITS_ARRIVED,(function(){if(!f)return;var t=n.usesSegments();t!==o.isRunning()&&(Vs.info("Turning segments data polling "+(t?"ON":"OFF")+"."),t?o.start():o.stop())})),n.usesSegments()?i.once(i.SDK_SPLITS_ARRIVED,l):setTimeout(l,0);var u=!1;function c(t,e){return u=!0,a(0,t,e).then((function(t){return u=!1,t}))}var f=!1;function l(){t.get(t.constants.READY,!0)||n.usesSegments()||s.emit(s.SDK_SEGMENTS_ARRIVED)}return{start:function(){f=!0,n.usesSegments()&&o.start()},stop:function(){f=!1,o.stop()},isRunning:function(){return f},isSynchronizingMySegments:function(){return u},synchronizeMySegments:c}},Qs=x("splitio-producer:updater"),Zs=function(t){var e=t.get(t.constants.SETTINGS),n=Hs(t),r=Fs(a,e.scheduler.featuresRefreshRate),i=Js(t),s=!1;function a(t){return s=!0,n(0,t).then((function(t){return s=!1,t}))}return{start:function(){Qs.info("Starting BROWSER producer"),r.start(),i.start()},stop:function(){Qs.info("Stopping BROWSER producer"),r.stop(),i.stop()},isRunning:r.isRunning,isSynchronizingSplits:function(){return s},synchronizeSplits:a,isSynchronizingMySegments:i.isSynchronizingMySegments,synchronizeMySegments:i.synchronizeMySegments}},$s=x("splitio-sync:sync-manager");var Xs=x("splitio-client:cleanup"),ta="unload",ea=function(){function t(t,e){this.storage=t.get(t.constants.STORAGE),this.settings=t.get(t.constants.SETTINGS),this.syncManager=e,this.flushData=this.flushData.bind(this),this.settings.sync.impressionsMode===wt&&(this.impressionsCounter=t.get(t.constants.IMPRESSIONS_COUNTER))}var e=t.prototype;return e.start=function(){"undefined"!==typeof window&&window.addEventListener&&(Xs.debug("Registering flush handler when unload page event is triggered."),window.addEventListener(ta,this.flushData))},e.stop=function(){"undefined"!==typeof window&&window.removeEventListener&&(Xs.debug("Deregistering flush handler when unload page event is triggered."),window.removeEventListener(ta,this.flushData))},e.flushData=function(){this._flushImpressions(),this._flushEvents(),this.impressionsCounter&&this._flushImpressionsCount(),this.syncManager&&this.syncManager.pushManager&&this.syncManager.pushManager.stop()},e._flushImpressions=function(){var t=this.storage.impressions;if(!t.isEmpty()){var e=this.settings.url("/testImpressions/beacon"),n=Mi(t,this.settings),r={sim:this.settings.sync.impressionsMode===wt?wt:Rt};this._sendBeacon(e,n,r)||Oi(Ii(this.settings,{body:JSON.stringify(n)})),t.clear()}},e._flushImpressionsCount=function(){var t={pf:Ki(this.impressionsCounter)};if(0!==t.pf.length){var e=this.settings.url("/testImpressions/count/beacon");this._sendBeacon(e,t)||Oi(Di(this.settings,{body:JSON.stringify(t)}))}},e._flushEvents=function(){var t=this.storage.events;if(!t.isEmpty()){var e=this.settings.url("/events/beacon"),n=t.toJSON();this._sendBeacon(e,n)||zi(Wi(this.settings,{body:JSON.stringify(n)})),t.clear()}},e._sendBeacon=function(t,e,n){if("undefined"!==typeof navigator&&navigator.sendBeacon){var r={entries:e,token:this.settings.core.authorizationKey,sdk:this.settings.version};n&&i()(r,n);var s=JSON.stringify(r);return navigator.sendBeacon(t,s)}return!1},t}(),na={};var ra=function(t,e,n){var r,s=!!n,a=t.get(t.constants.SETTINGS),o=t.get(t.constants.READINESS),u=t.get(t.constants.STORAGE),c=t.get(t.constants.STATUS_MANAGER),f=o.gate,l=o.splits,h=o.segments,p=f.SDK_READY,g=s?void 0:ji(t),d=s?void 0:Bi(t);switch(a.mode){case dt:case gt:t.put(t.constants.COLLECTORS,g&&g.collectors),s?r=na[a.core.authorizationKey].shared(t):(r=function(t){var e={},n=t.get(t.constants.SETTINGS),r=c(!1,t),i=n.streamingEnabled?xs(t,e):void 0,s=t.get(t.constants.PRODUCER);function a(){s.isRunning()?$s.info("Streaming couldn't connect. Continue periodic fetch of data."):($s.info("Streaming not available. Starting periodic fetch of data."),S(e,(function(t){t.get(t.constants.PRODUCER).start()})))}function o(){s.isRunning()&&($s.info("PUSH (re)connected. Syncing and stopping periodic fetch of data."),S(e,(function(t){t.get(t.constants.PRODUCER).stop()}))),u()}function u(){t.get(t.constants.PRODUCER).synchronizeSplits(),S(e,(function(t){t.get(t.constants.PRODUCER).synchronizeMySegments()}))}function c(t,n){var r=t?Js(n):Zs(n),c=n.get(n.constants.SETTINGS),f=v(ue(c.core.key));return n.put(n.constants.PRODUCER,r),e[f]&&$s.warn("A client with the same user key has already been created. Only the new instance will be properly synchronized."),e[f]=n,{start:function(){i?(t?s.isRunning()?r.start():r.synchronizeMySegments():(u(),i.on(ss,o),i.on(as,a)),i.startNewClient(f,n)):r.start()},stop:function(){e[f]&&(delete e[f],i&&(i.removeClient(f),t||i.stop()),r.isRunning()&&r.stop())}}}return r.shared=c.bind(null,!0),r.pushManager=i,r}(t),na[a.core.authorizationKey]=r);break;case mt:t.put(t.constants.READY_FROM_CACHE,!0)}var m=s?void 0:new ea(t,r);if(e&&r&&!s){var y=e.sdkReadyTracker,T=e.splitsReadyTracker,E=e.segmentsReadyTracker;y.setCollectorForTask(g.collectors),f.once(p,y),l.once(l.SDK_SPLITS_ARRIVED,T),h.once(h.SDK_SEGMENTS_ARRIVED,E)}r&&r.start(),g&&g.start(),d&&t.put(t.constants.EVENTS,d)&&d.start(),t.put(t.constants.COLLECTORS,n);var b=i()(Object.create(c),fi(t),{destroy:function(){return r&&r.stop(),g&&g.stop(),d&&d.stop(),Promise.all([g&&g.flush(),d&&d.flush()]).then((function(){o.destroy(),m&&m.stop(),u.destroy&&u.destroy(),t.put(t.constants.DESTROYED,!0),s||(G(a.core.authorizationKey),delete na[a.core.authorizationKey])}))}});return!s&&m.start(b.destroy),{api:b,metricCollectors:g&&g.collectors}};function ia(t){var e=t.treatment;return t.keys?{conditionType:"WHITELIST",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"WHITELIST",negate:!1,whitelistMatcherData:{whitelist:f(t.keys)?[t.keys]:t.keys}}]},partitions:[{treatment:e,size:100}],label:"whitelisted "+e}:{conditionType:"ROLLOUT",matcherGroup:{combiner:"AND",matchers:[{keySelector:null,matcherType:"ALL_KEYS",negate:!1}]},partitions:[{treatment:e,size:100}],label:"default rule"}}function sa(){var t={emptyMock:1};return function(e){var n=e.features||{};if(!function(e){var n=Object.keys(e);return n.length!==Object.keys(t).length?(t=e,!0):n.some((function(n){var r,i,s=!t[n],a=typeof(r=t[n])!==typeof(i=e[n])||("string"===typeof r?r!==i:r.treatment!==i.treatment||r.config!==i.config),o=s||a;return o&&(t=e),o}))}(n))return!1;var r={};return S(n,(function(t,e){var n=t,i=null;g(t)&&(n=t.treatment,i=t.config||i);var s={};null!==i&&(s[n]=i),r[e]={trafficTypeName:"localhost",conditions:[ia({treatment:n})],configurations:s}})),r}}var aa=x("splitio-producer:offline");var oa=function(t,e){var n=e.getAll(),r=n[e.constants.SETTINGS],i=n[e.constants.READINESS],s=n[e.constants.STORAGE],a=!0;return function(){var e=[],n=null,o={};try{o=t(r)}catch(u){n=u,aa.error("There was an issue loading the mock Splits data, no changes will be applied to the current cache. "+u)}return!n&&o?(aa.debug("Splits data: "),aa.debug(JSON.stringify(o)),S(o,(function(t,n){e.push([n,JSON.stringify({name:n,status:"ACTIVE",killed:!1,trafficAllocation:100,defaultTreatment:"control",conditions:t.conditions||[],configurations:t.configurations,trafficTypeName:t.trafficTypeName})])})),Promise.all([s.splits.flush(),s.splits.addSplits(e)]).then((function(){i.splits.emit(i.splits.SDK_SPLITS_ARRIVED),a&&(a=!1,r.storage.__originalType===yt&&i.splits.emit(i.splits.SDK_SPLITS_CACHE_LOADED),i.segments.emit(i.segments.SDK_SEGMENTS_ARRIVED))}))):Promise.resolve()}};var ua=function(t){var e=t.get(t.constants.SETTINGS),n=function(t){var e=sa();return oa(e,t)}(t);return Fs(n,e.scheduler.offlineRefreshRate)};var ca=function(t,e){var n=!e,r=t.get(t.constants.READINESS),s=t.get(t.constants.STORAGE),a=t.get(t.constants.STATUS_MANAGER);n&&setTimeout((function(){r.splits.on(r.splits.SDK_SPLITS_ARRIVED,(function(){r.gate.emit(r.gate.SDK_UPDATE)})),r.gate.emit(r.gate.SDK_READY)}),0);var o=n?void 0:ua(t);return o&&o.start(),{api:i()(Object.create(a),fi(t),{destroy:function(){return o&&o.stop(),r.destroy(),s.destroy&&s.destroy(),t.put(t.constants.DESTROYED,!0),!n&&G(),Promise.resolve()}}),metricCollectors:!1}};function fa(t,e){var n=!1,r=!1;var i=function t(i){var s=new Promise((function(t,n){return i.then(t,(function(t){r?n(t):e(t)}))})),a=s.then;return Object.defineProperty(s,"then",{value:function(e,i){var o=a.call(s,e,i);return"function"===typeof e&&(n=!0),"function"===typeof i?(r=!0,o):t(o)}}),s}(t);return i.hasOnFulfilled=function(){return n},i}var la=x("");function ha(t){la.error(t)}function pa(t,e){void 0===e&&(e=0);var n=t.get(t.constants.READINESS).gate,r=0,s=!1,a=!1,o=n.SDK_READY,u=n.SDK_READY_FROM_CACHE,c=n.SDK_UPDATE,f=n.SDK_READY_TIMED_OUT;n.on("removeListener",(function(t){t===o&&r--})),n.on("newListener",(function(t){t!==o&&t!==f||(s?la.error("A listener was added for "+(t===o?"SDK_READY":"SDK_READY_TIMED_OUT")+" on the SDK, which has already fired and won't be emitted again. The callback won't be executed."):t===o&&r++)}));var l=function(){var i=fa(new Promise((function(u,c){n.once(o,(function(){la.info("Split SDK is ready."),r!==e||i.hasOnFulfilled()||la.warn("No listeners for SDK Readiness detected. Incorrect control treatments could have been logged if you called getTreatment/s while the SDK was not yet ready."),t.put(t.constants.READY,!0),s=!0,u()})),n.once(f,(function(e){t.put(t.constants.HAS_TIMEDOUT,!0),a=!0,c(e)}))})),ha);return i}();return n.once(u,(function(){la.info("Split SDK is ready from cache."),t.put(t.constants.READY_FROM_CACHE,!0)})),i()(Object.create(n),{Event:{SDK_READY:o,SDK_READY_FROM_CACHE:u,SDK_UPDATE:c,SDK_READY_TIMED_OUT:f},ready:function(){return a?s?Promise.resolve():fa(Promise.reject("Split SDK has emitted SDK_READY_TIMED_OUT event."),ha):l},__context:t})}var ga="splitio-ga-to-split",da=ga+":mapper",ma=x(ga);var va,ya=(va={eventTypeId:{event:"eventAction",social:"socialAction"},eventValue:{event:"eventValue",timing:"timingValue"},eventProperties:{pageview:["page"],screenview:["screenName"],event:["eventCategory","eventLabel"],social:["socialNetwork","socialTarget"],timing:["timingCategory","timingVar","timingLabel"],exception:["exDescription","exFatal"]}},function(t){var e=t.get("hitType"),n=t.get(va.eventTypeId[e]||"hitType"),r=t.get(va.eventValue[e]),i={},s=va.eventProperties[e];if(s)for(var a=0;a<s.length;a++)i[s[a]]=t.get(s[a]);return{eventTypeId:n,value:r,properties:i,timestamp:Date.now()}});function Sa(t){return Array.isArray(t)?function(t,e){void 0===e&&(e=JSON.stringify);var n={};return t.filter((function(t){var r=e(t);return!Object.prototype.hasOwnProperty.call(n,r)&&(n[r]=!0)}))}(t).filter((function(t){if(!t)return!1;var e=t.key,n=t.trafficType;return!(!f(e)&&!l(e))&&!!f(n)})):[]}var Ta=/^[^a-zA-Z0-9]+/,Ea=/[^-_.:a-zA-Z0-9]+/g;var ba=function(t,e,n){var r={prefix:"ga",identities:n.key&&n.trafficType?[{key:n.key,trafficType:n.trafficType}]:void 0};!function(t,e){var n=window.GoogleAnalyticsObject||"ga";window[n]=window[n]||function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];(window[n].q=window[n].q||[]).push(e)},window[n]("provide",t,e)}("splitTracker",(function(n,s){var a=i()({},r,t,s);this.tracker=n;var o=Sa(a.identities);if(0!==o.length){var u=o.length-a.identities.length;u&&ma.warn(u+" identities were discarded because they are invalid or duplicated. Identities must be an array of objects with key and trafficType."),a.identities=o,f(a.prefix)||(ma.warn("The provided `prefix` was ignored since it is invalid. Please check that you are passing a string object as `prefix`."),a.prefix=void 0);var c=n.get("sendHitTask");n.set("sendHitTask",(function(t){if(c(t),!1!==a.hits&&!t.get("splitHit")){try{if(a.filter&&!a.filter(t))return}catch(r){return void ma.warn("GaToSplit custom filter threw: "+r)}var n=ya(t);if(a.mapper){try{n=a.mapper(t,n)}catch(r){return void ma.warn("GaToSplit custom mapper threw: "+r)}if(!n)return}a.prefix&&(n.eventTypeId=a.prefix+"."+n.eventTypeId),n.eventTypeId=function(t){if(!f(t)||0===t.length)return t;var e=t.replace(Ta,"").replace(Ea,"_"),n=e.slice(0,80);return n.length<e.length&&ma.warn("EventTypeId was truncated because it cannot be more than 80 characters long."),n}(n.eventTypeId),function(t){return!!Y(t.eventTypeId,da)&&!1!==V(t.value,da)&&!1!==et(t.properties,da).properties&&!(t.timestamp&&!l(t.timestamp))&&(!t.key||!1!==it(t.key,da))&&(!t.trafficTypeName||!1!==Ot(t.trafficTypeName,da))}(n)&&(n.key&&n.trafficTypeName?e.events.track(n):a.identities.forEach((function(t){var r=i()({key:t.key,trafficTypeName:t.trafficType},n);e.events.track(r)})))}})),ma.info("Started GA-to-Split integration")}else ma.warn("No valid identities were provided. Please check that you are passing a valid list of identities or providing a traffic type at the SDK configuration.")}))},_a=x("splitio-split-to-ga"),Aa=function(){function t(e){if("function"!==typeof t.getGa())return _a.warn("`ga` command queue not found. No hits will be sent."),{};this.trackerNames=t.defaultTrackerNames,e&&("function"===typeof e.filter&&(this.filter=e.filter),"function"===typeof e.mapper&&(this.mapper=e.mapper),Array.isArray(e.trackerNames)&&(this.trackerNames=m(e.trackerNames)),this.impressions=e.impressions,this.events=e.events),_a.info("Started Split-to-GA integration")}return t.defaultMapper=function(t){var e=t.type,n=t.payload;switch(e){case _t:return{hitType:"event",eventCategory:"split-impression",eventAction:"Evaluate "+n.impression.feature,eventLabel:"Treatment: "+n.impression.treatment+". Targeting rule: "+n.impression.label+".",nonInteraction:!0};case At:return{hitType:"event",eventCategory:"split-event",eventAction:n.eventTypeId,eventValue:n.value,nonInteraction:!0}}return null},t.getGa=function(){return"undefined"!==typeof window?window[window.GoogleAnalyticsObject||"ga"]:void 0},t.validateFieldsObject=function(t){return!(!t||!t.hitType)||(_a.warn("your custom mapper returned an invalid FieldsObject instance. It must be an object with at least a `hitType` field."),!1)},t.prototype.queue=function(e){var n=t.getGa();if(n){if(!1===this.impressions&&e.type===_t)return;if(!1===this.events&&e.type===At)return;var r;try{if(this.filter&&!this.filter(e))return;if(r=t.defaultMapper(e),this.mapper&&(!(r=this.mapper(e,r))||!t.validateFieldsObject(r)))return}catch(i){return void _a.warn("SplitToGa queue method threw: "+i+". No hit was sent.")}this.trackerNames.forEach((function(t){var e=t?t+".send":"send";r.splitHit=!0,n(e,r)}))}},t}();Aa.defaultTrackerNames=[""];var Na=Aa,Ra=function(t){var e=t.get(t.constants.SETTINGS),n=[];if(e.integrations.forEach((function(r){var i;switch(r.type){case Et:var s=t.get(t.constants.STORAGE),a=e.core;i=ba(r,s,a);break;case bt:i=new Na(r)}i&&i.queue&&n.push(i)})),0!==n.length)return{handleImpression:function(t){n.forEach((function(e){return e.queue({type:_t,payload:t})}))},handleEvent:function(t){n.forEach((function(e){return e.queue({type:At,payload:t})}))}}},wa=function(){function t(){this.cache={}}var e=t.prototype;return e._makeKey=function(t,e){return t+"::"+Xr(e)},e.inc=function(t,e,n){var r=this._makeKey(t,e),i=this.cache[r];this.cache[r]=i?i+n:n},e.popAll=function(){var t={};return i()(t,this.cache),this.cache={},t},e.size=function(){return Object.keys(this.cache).length},t}(),Ca=x("splitio"),ka=function(t,e){return(t.matchingKey?t.matchingKey:t)+"-"+(t.bucketingKey?t.bucketingKey:t)+"-"+(void 0!==e?e:"")};function Oa(t){var e={},n={splitsReadyTracker:nn.start(nn.TaskNames.SPLITS_READY),segmentsReadyTracker:nn.start(nn.TaskNames.SEGMENTS_READY),sdkReadyTracker:nn.start(nn.TaskNames.SDK_READY)},r=new We,i=je(t);r.put(r.constants.SETTINGS,i),function(t){var e=!1;void 0==t?L.error("Factory instantiation: you passed a null or undefined api_key, api_key must be a non-empty string."):f(t)?t.length>0?e=t:L.error("Factory instantiation: you passed an empty api_key, api_key must be a non-empty string."):L.error("Factory instantiation: you passed an invalid api_key, api_key must be a non-empty string."),e&&(F[e]?(L.warn("Factory instantiation: You already have "+F[e]+" "+(1===F[e]?"factory":"factories")+" with this API Key. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application."),F[e]++):(F[e]=1,Object.keys(F).length>1&&L.warn("Factory instantiation: You already have an instance of the Split factory. Make sure you definitely want this additional instance. We recommend keeping only one instance of the factory at all times (Singleton pattern) and reusing it throughout your application.")))}(i.core.authorizationKey);var s=be(),a=s(i.startup.readyTimeout);r.put(r.constants.READINESS,a);var o=pa(r);r.put(r.constants.STATUS_MANAGER,o);var u=le(r);r.put(r.constants.STORAGE,u);var c=new wa;r.put(r.constants.IMPRESSIONS_COUNTER,c);var l=Ra(r);r.put(r.constants.INTEGRATIONS_MANAGER,l);var h=i.mode===pt?ca:ra,p=h(r,n),g=p.api,d=p.metricCollectors,m=Ft(u.splits,r),v=He(i.core.key),y=ka(v,i.core.trafficType);return e[y]=g,Ca.info("New Split SDK instance created."),{client:function(t,n){if(void 0===t)return Ca.debug("Retrieving default SDK client."),g;if("function"!=typeof u.shared)throw new Error("Shared Client not supported by the storage mechanism. Create isolated instances instead.");var a,o=it(t,"Shared Client instantiation");if(!1===o)throw new Error("Shared Client needs a valid key.");if(void 0!==n&&!1===(a=Ot(n,"Shared Client instantiation")))throw new Error("Shared Client needs a valid traffic type or no traffic type at all.");var f=ka(o,a);if(e[f])Ca.debug("Retrieving existing SDK client.");else{var l=i.overrideKeyAndTT(o,a),p=new We,m=s(l.startup.readyTimeout);p.put(r.constants.READY_FROM_CACHE,r.get(r.constants.READY_FROM_CACHE,!0)),p.put(r.constants.READINESS,m),p.put(r.constants.STATUS_MANAGER,pa(p,-1)),p.put(r.constants.SETTINGS,l),p.put(r.constants.STORAGE,u.shared(l)),p.put(r.constants.IMPRESSIONS_COUNTER,c),e[f]=h(p,!1,d).api,Ca.info("New shared client instance created.")}return e[f]},manager:function(){return Ca.info("Manager instance retrieved."),m},Logger:P,settings:i}}},48983:function(t,e,n){var r=n(40371)("length");t.exports=r},23933:function(t,e,n){var r=n(44239),i=n(37005);t.exports=function(t){return i(t)&&"[object RegExp]"==r(t)}},25970:function(t,e,n){var r=n(63012),i=n(79095);t.exports=function(t,e){return r(t,e,(function(e,n){return i(t,n)}))}},88016:function(t,e,n){var r=n(48983),i=n(62689),s=n(21903);t.exports=function(t){return i(t)?s(t):r(t)}},21903:function(t){var e="[\\ud800-\\udfff]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",r="\\ud83c[\\udffb-\\udfff]",i="[^\\ud800-\\udfff]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",o="(?:"+n+"|"+r+")"+"?",u="[\\ufe0e\\ufe0f]?",c=u+o+("(?:\\u200d(?:"+[i,s,a].join("|")+")"+u+o+")*"),f="(?:"+[i+n+"?",n,s,a,e].join("|")+")",l=RegExp(r+"(?="+r+")|"+f+c,"g");t.exports=function(t){for(var e=l.lastIndex=0;l.test(t);)++e;return e}},96347:function(t,e,n){var r=n(23933),i=n(7518),s=n(31167),a=s&&s.isRegExp,o=a?i(a):r;t.exports=o},78718:function(t,e,n){var r=n(25970),i=n(99021)((function(t,e){return null==t?{}:r(t,e)}));t.exports=i},39138:function(t,e,n){var r=n(80531),i=n(40180),s=n(62689),a=n(13218),o=n(96347),u=n(88016),c=n(83140),f=n(40554),l=n(79833),h=/\w*$/;t.exports=function(t,e){var n=30,p="...";if(a(e)){var g="separator"in e?e.separator:g;n="length"in e?f(e.length):n,p="omission"in e?r(e.omission):p}var d=(t=l(t)).length;if(s(t)){var m=c(t);d=m.length}if(n>=d)return t;var v=n-u(p);if(v<1)return p;var y=m?i(m,0,v).join(""):t.slice(0,v);if(void 0===g)return y+p;if(m&&(v+=y.length-v),o(g)){if(t.slice(v).search(g)){var S,T=y;for(g.global||(g=RegExp(g.source,l(h.exec(g))+"g")),g.lastIndex=0;S=g.exec(T);)var E=S.index;y=y.slice(0,void 0===E?v:E)}}else if(t.indexOf(r(g),v)!=v){var b=y.lastIndexOf(g);b>-1&&(y=y.slice(0,b))}return y+p}},63144:function(t){"use strict";var e=self.fetch.bind(self);t.exports=e,t.exports.default=t.exports},69590:function(t){var e="undefined"!==typeof Element,n="function"===typeof Map,r="function"===typeof Set,i="function"===typeof ArrayBuffer&&!!ArrayBuffer.isView;function s(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var o,u,c,f;if(Array.isArray(t)){if((o=t.length)!=a.length)return!1;for(u=o;0!==u--;)if(!s(t[u],a[u]))return!1;return!0}if(n&&t instanceof Map&&a instanceof Map){if(t.size!==a.size)return!1;for(f=t.entries();!(u=f.next()).done;)if(!a.has(u.value[0]))return!1;for(f=t.entries();!(u=f.next()).done;)if(!s(u.value[1],a.get(u.value[0])))return!1;return!0}if(r&&t instanceof Set&&a instanceof Set){if(t.size!==a.size)return!1;for(f=t.entries();!(u=f.next()).done;)if(!a.has(u.value[0]))return!1;return!0}if(i&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(a)){if((o=t.length)!=a.length)return!1;for(u=o;0!==u--;)if(t[u]!==a[u])return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((o=(c=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(u=o;0!==u--;)if(!Object.prototype.hasOwnProperty.call(a,c[u]))return!1;if(e&&t instanceof Element)return!1;for(u=o;0!==u--;)if(("_owner"!==c[u]&&"__v"!==c[u]&&"__o"!==c[u]||!t.$$typeof)&&!s(t[c[u]],a[c[u]]))return!1;return!0}return t!==t&&a!==a}t.exports=function(t,e){try{return s(t,e)}catch(n){if((n.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw n}}},81385:function(t,e,n){"use strict";n.d(e,{C8:function(){return i},dK:function(){return a},mq:function(){return s}});var r=n(67294),i=r.createContext(),s=r.createContext();function a(t){var e=t.children,n=r.useState(null),a=n[0],o=n[1],u=r.useRef(!1);r.useEffect((function(){return function(){u.current=!0}}),[]);var c=r.useCallback((function(t){u.current||o(t)}),[]);return r.createElement(i.Provider,{value:a},r.createElement(s.Provider,{value:c},e))}},74688:function(t,e,n){"use strict";n.d(e,{r:function(){return f}});var r=n(67294),i=n(81385),s=n(67139),a=n(40867),o=function(){},u=function(){return Promise.resolve(null)},c=[];function f(t){var e=t.placement,n=void 0===e?"bottom":e,f=t.strategy,l=void 0===f?"absolute":f,h=t.modifiers,p=void 0===h?c:h,g=t.referenceElement,d=t.onFirstUpdate,m=t.innerRef,v=t.children,y=r.useContext(i.C8),S=r.useState(null),T=S[0],E=S[1],b=r.useState(null),_=b[0],A=b[1];r.useEffect((function(){(0,s.k$)(m,T)}),[m,T]);var N=r.useMemo((function(){return{placement:n,strategy:l,onFirstUpdate:d,modifiers:[].concat(p,[{name:"arrow",enabled:null!=_,options:{element:_}}])}}),[n,l,d,p,_]),R=(0,a.D)(g||y,T,N),w=R.state,C=R.styles,k=R.forceUpdate,O=R.update,I=r.useMemo((function(){return{ref:E,style:C.popper,placement:w?w.placement:n,hasPopperEscaped:w&&w.modifiersData.hide?w.modifiersData.hide.hasPopperEscaped:null,isReferenceHidden:w&&w.modifiersData.hide?w.modifiersData.hide.isReferenceHidden:null,arrowProps:{style:C.arrow,ref:A},forceUpdate:k||o,update:O||u}}),[E,A,n,w,C,O,k]);return(0,s.$p)(v)(I)}},63351:function(t,e,n){"use strict";n.d(e,{s:function(){return u}});var r=n(67294),i=n(42473),s=n.n(i),a=n(81385),o=n(67139);function u(t){var e=t.children,n=t.innerRef,i=r.useContext(a.mq),u=r.useCallback((function(t){(0,o.k$)(n,t),(0,o.DL)(i,t)}),[n,i]);return r.useEffect((function(){return function(){return(0,o.k$)(n,null)}})),r.useEffect((function(){s()(Boolean(i),"`Reference` should not be used outside of a `Manager` component.")}),[i]),(0,o.$p)(e)({ref:u})}},40867:function(t,e,n){"use strict";n.d(e,{D:function(){return c}});var r=n(67294),i=n(96416),s=n(69590),a=n.n(s),o=n(67139),u=[],c=function(t,e,n){void 0===n&&(n={});var s=r.useRef(null),c={onFirstUpdate:n.onFirstUpdate,placement:n.placement||"bottom",strategy:n.strategy||"absolute",modifiers:n.modifiers||u},f=r.useState({styles:{popper:{position:c.strategy,left:"0",top:"0"},arrow:{position:"absolute"}},attributes:{}}),l=f[0],h=f[1],p=r.useMemo((function(){return{name:"updateState",enabled:!0,phase:"write",fn:function(t){var e=t.state,n=Object.keys(e.elements);h({styles:(0,o.sq)(n.map((function(t){return[t,e.styles[t]||{}]}))),attributes:(0,o.sq)(n.map((function(t){return[t,e.attributes[t]]})))})},requires:["computeStyles"]}}),[]),g=r.useMemo((function(){var t={onFirstUpdate:c.onFirstUpdate,placement:c.placement,strategy:c.strategy,modifiers:[].concat(c.modifiers,[p,{name:"applyStyles",enabled:!1}])};return a()(s.current,t)?s.current||t:(s.current=t,t)}),[c.onFirstUpdate,c.placement,c.strategy,c.modifiers,p]),d=r.useRef();return(0,o.LI)((function(){d.current&&d.current.setOptions(g)}),[g]),(0,o.LI)((function(){if(null!=t&&null!=e){var r=(n.createPopper||i.fi)(t,e,g);return d.current=r,function(){r.destroy(),d.current=null}}}),[t,e,n.createPopper]),{state:d.current?d.current.state:null,styles:l.styles,attributes:l.attributes,update:d.current?d.current.update:null,forceUpdate:d.current?d.current.forceUpdate:null}}},67139:function(t,e,n){"use strict";n.d(e,{$p:function(){return i},DL:function(){return s},LI:function(){return u},k$:function(){return a},sq:function(){return o}});var r=n(67294),i=function(t){return Array.isArray(t)?t[0]:t},s=function(t){if("function"===typeof t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t.apply(void 0,n)}},a=function(t,e){if("function"===typeof t)return s(t,e);null!=t&&(t.current=e)},o=function(t){return t.reduce((function(t,e){var n=e[0],r=e[1];return t[n]=r,t}),{})},u="undefined"!==typeof window&&window.document&&window.document.createElement?r.useLayoutEffect:r.useEffect},43144:function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,{Z:function(){return i}})},61120:function(t,e,n){"use strict";function r(t){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},r(t)}n.d(e,{Z:function(){return r}})}}]);